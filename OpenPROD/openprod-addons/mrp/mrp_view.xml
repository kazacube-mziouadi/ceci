<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <menuitem name="Production" id="menu_production_main" sequence="16" groups="base.group_manufacturing_user" web_icon="base_openprod,static/description/production.png" />
        <menuitem name="Manufacturing" id="menu_production_manufacturing" parent="menu_production_main" sequence="10" />
        <menuitem name="Subcontracting" id="menu_production_subcontracting" parent="menu_production_main" sequence="15" />
        <menuitem name="Planning" id="menu_production_planning" parent="menu_production_main" sequence="20" />
        <menuitem name="Production Monitoring" id="menu_production_declaration" parent="menu_production_main" sequence="30" />
        <menuitem name="Analysis" id="menu_production_analysis" parent="menu_production_main" sequence="40" />
        <menuitem name="Configuration" id="menu_production_configuration" parent="menu_production_main" sequence="50" />

        <menuitem name="BoM" id="menu_mrp_bom" parent="base_openprod.menu_technical_data_main" sequence="10" />
        <menuitem name="Routing" id="menu_mrp_routing" parent="base_openprod.menu_technical_data_main" sequence="5" />
        <menuitem name="BoM" id="menu_bom_conf" parent="base_openprod.menu_technical_data_configuration" sequence="20" />
        <menuitem name="Parameter Dimension Type" action="sale.action_parameter_dimension_type" id="menu_parameter_dimension_type" parent="menu_bom_conf" groups="sale.group_menu_sale_config" sequence="30" />
        <menuitem name="Routing" id="menu_routing_conf" parent="base_openprod.menu_technical_data_configuration" sequence="10" />
        <menuitem name="Wizard Report WO Planning" action="act_report_wo_planning_id" id="menu_report_wo_planning_id" parent="menu_production_planning" groups="group_menu_manuf_plan" />
        <menuitem name="Production Operator Time" action="production_operator_time_action" id="menu_mrp_production_operator_time_action" parent="menu_production_analysis" sequence="10" groups="group_menu_manuf_analyse" />

        <!-- =================== -->
        <!-- Nomenclatures -->
        <!-- =================== -->

        <record id="mrp_bom_component_structure_tree_view" model="ir.ui.view">
            <field name="name">mrp.bom.component.tree</field>
            <field name="model">mrp.bom</field>
            <field name="type">tree</field>
            <field name="field_parent">child_structure_ids</field>
            <field name="priority">10</field>
            <field name="arch" type="xml">
                <tree string="BoM Structure" colors="red:state!='active'">
                    <field name="sequence" invisible="1" />
                    <field name="product_id" />
                    <field name="qty_with_factor" />
                    <field name="uom_id" />
                    <field name="type" />
                    <field name="start_date" />
                    <field name="stop_date" />
                    <field name="routing_first_id" />
                    <field name="state" />
                </tree>
            </field>
        </record>
        <!-- ACTION Structure -->
        <record id="action_structure_tree3" model="ir.actions.act_window">
            <field name="name">Bill of Materials Structure</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.bom</field>
            <field name="domain">[('id','in',active_ids)]</field>
            <field name="view_id" ref="mrp_bom_component_structure_tree_view" />
            <field name="view_type">tree</field>
            <field name="view_type">tree</field>
        </record>

        <record id="ir_BOM_structure" model="ir.values">
            <field eval="'client_action_multi'" name="key2" />
            <field eval="'mrp.bom'" name="model" />
            <field name="name">Bill of Materials Structure</field>
            <field eval="'ir.actions.act_window,'+str(action_structure_tree3)" name="value" />
        </record>

        <!-- FORM VIEW Bom -->
        <record id='view_form_mrp_bom' model='ir.ui.view'>
            <field name="name">view_form_mrp_bom</field>
            <field name="model">mrp.bom</field>
            <field name="arch" type="xml">
                <form string="BoM" version="8.0">
                    <header>
                        <button name="wkf_draft" states="obsolete" string="Draft" type="object" class="oe_highlight" />
                        <button name="wkf_active" states="draft" string="Active" type="object" class="oe_highlight" />
                        <button name="wkf_obsolete" states="draft,active" string="Obsolete" type="object" class="oe_highlight" />
                        <field name="state" widget="statusbar" statusbar_visible="draft, active, obsolete" />
                    </header>
                    <group colspan="4" col="9">
                        <group colspan="8">
                            <group colspan="8" col="8" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                <group colspan="4" col="4">
                                    <field name="product_id" domain="[('produce_ok','=',True)]" colspan="4" attrs="{'invisible': [('type', '=', 'family')], 'required': [('type', '!=', 'family')]}" />
                                    <field name="prod_family_id" colspan="4" attrs="{'invisible': [('type', '!=', 'family')], 'required': [('type', '=', 'family')]}" />
                                    <field name="name" colspan="4" />
                                    <field name="type" colspan="4" />
                                </group>
                                <group colspan="4" col="4">
                                    <group colspan="2" col="2">
                                        <field name="quantity" />
                                        <field name="start_date" />
                                        <field name="price_qty" />
                                    </group>
                                    <group colspan="2" col="2">
                                        <field name="uom_id" domain="[('category_id','=',uom_category_id)]" />
                                        <field name="stop_date" />
                                        <field name="production_cost_price" />
                                        <field name="uom_category_id" invisible="1" />
                                    </group>
                                </group>
                            </group>
                            <notebook colspan="8">
                                <page string="Components" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                    <field name="bom_ids" nolabel="1" colspan="8">
                                        <tree string="Components" editable="bottom" colors="red:qty_component_compute==0">
                                            <field name="sequence" invisible="1" />
                                            <field name="name" invisible="1" />
                                            <field name="product_id" required="1" />
                                            <field name="quantity" />
                                            <field name="uom_category_id" invisible="1" />
                                            <field name="uom_id" domain="[('category_id', '=', uom_category_id)]" />
                                            <field name="round" />
                                            <field name="efficiency" />
                                            <field name="option_id" groups="mrp.mrp_options" />
                                            <field name="property_ids" widget="many2many_tags" groups="product.purchase_properties" domain="[('sinfo_property_product', 'in', product_id)]" />
                                            <field name="type_component" />
                                            <field name="formula_component" readonly="1" />
                                            <button name="action_return_formula_component" string="Save" type="object" icon="terp-tools" />
                                            <field name="qty_component_compute" />
                                            <field name="price_unit" />
                                            <field name="is_valid_priceunit" invisible="1" />
                                            <field name="price_total_component" />
                                        </tree>
                                        <form string="BoM" version="8.0">
                                            <group colspan="4" col="6">
                                                <group colspan="2" col="2">
                                                    <field name="product_id" required="1" />
                                                    <field name="type_component" />
                                                    <field name="option_id" groups="mrp.mrp_options" />
                                                    <field name="qty_component_compute" invisible="1" />
                                                    <field name="price_unit" invisible="1" />
                                                </group>
                                                <group colspan="2" col="2">
                                                    <field name="quantity" />
                                                    <field name="round" />
                                                    <field name="property_ids" widget="many2many_tags" groups="product.purchase_properties" domain="[('sinfo_property_product', 'in', product_id)]" />
                                                </group>
                                                <group colspan="2" col="2">
                                                    <field name="uom_id" domain="[('category_id','=',uom_category_id)]" />
                                                    <field name="efficiency" />
                                                </group>
                                            </group>
                                            <group colspan="4" col="4">
                                                <group colspan="4" col="4" string="Formula qty" name="group_formula_component">
                                                    <field name="formula_component" readonly="1" nolabel="1" colspan="3" />
                                                    <button name="action_return_formula_component" string="Open formula" type="object" class="oe_inline oe_stat_button" icon="fa-check" colspan="1" />
                                                </group>
                                            </group>
                                            <group colspan="4" col="4" string="Cost history">
                                                <field name="component_cost_history_ids" readonly="1" colspan="4" nolabel="1">
                                                    <tree string="Cost history" editable="bottom" create="false">
                                                        <field name="date" />
                                                        <field name="currency_id" />
                                                        <field name="price_qty" />
                                                        <field name="price" />
                                                        <field name="user_id" />
                                                    </tree>
                                                </field>
                                            </group>
                                            <field name="uom_category_id" invisible="1" />
                                        </form>
                                    </field>
                                </page>
                                <page string="Revision" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                    <group colspan="4" col="2">
                                        <group colspan="2" col="4" string="Revision">
                                            <field name="revison_ids" nolabel="1" />
                                        </group>
                                        <group colspan="2" col="4" string="Version historical">
                                            <field name="version_historical_ids" nolabel="1">
                                                <tree>
                                                    <field name="start_date" />
                                                    <field name="version" />
                                                </tree>
                                            </field>
                                        </group>
                                        <field name="version" />
                                    </group>
                                </page>
                                <page string="Informations" autofocus="toutsaufautofocus" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                    <group colspan="4" col="4" string="Model">
                                        <field name="is_model" string="Is model" attrs="{'invisible': [('template_id', '!=', False)]}" />
                                        <field name="template_id" attrs="{'invisible': [('is_model', '!=', False)],'readonly': [('bom_ids', '!=', [])]}" domain="[('is_model','=',True)]" context="{'default_is_model': True}" />
                                    </group>
                                    <group colspan="8" string="Infomations">
                                        <group colspan="8" col="6">
                                            <group colspan="2" col="2">
                                                <field name="company_id" />
                                                <field name="round" />
                                            </group>
                                            <group colspan="2" col="2">
                                                <field name="option_id" groups="mrp.mrp_options" />
                                                <field name="efficiency" />
                                            </group>
                                            <group colspan="2" col="2">
                                                <field name="active" />
                                                <field name="property_ids" widget="many2many_tags" groups="product.purchase_properties" domain="[('sinfo_property_product', 'in', product_id)]" />
                                            </group>
                                        </group>
                                        <label for="note_mo" string="Note on wo" />
                                        <field name="note_mo" nolabel="1" colspan="4" />
                                    </group>
                                </page>
                                <page string="Declension" attrs="{'invisible': [('is_model', '!=', True)]}">
                                    <field name="template_ids" nolabel="1" colspan="8" readonly="1" attrs="{'readonly': [('state', '!=', 'draft')]}" />
                                </page>
                                <page string="Routing" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                    <field name="routing_ids" nolabel="1" colspan="8" context="{'view_sequence': False}" />
                                </page>
                                <page string="Subporduct" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                    <field name="subproduct_ids" nolabel="1" colspan="8">
                                        <tree string="Components" editable="bottom">
                                            <field name="sequence" />
                                            <field name="product_id" />
                                            <field name="quantity" />
                                            <field name="uom_category_id" invisible="1" />
                                            <field name="uom_id" domain="[('category_id','=',uom_category_id)]" />
                                            <field name="type" />
                                            <field name="bom_id" invisible="1" />
                                            <field name="round" />
                                            <field name="efficiency" />
                                            <field name="option_id" groups="mrp.mrp_options" />
                                            <field name="price_unit" />
                                            <field name="is_valid_priceunit" />
                                            <field name="price_total" />
                                        </tree>
                                    </field>
                                </page>
                                <page string="Cost" attrs="{'readonly': [('state', '!=', 'draft')]}">
                                    <group colspan="8" col="6" string="Cost">
                                        <group colspan="2" col="2">
                                            <field name="component_total_price" readonly="1" />
                                            <field name="price_unit" readonly="1" />
                                            <field name="routing_first_price" readonly="1" />
                                        </group>
                                        <group colspan="2" col="2">
                                            <field name="price_last_date" readonly="1" />
                                            <field name="total_efficiency" readonly="1" />
                                            <field name="routing_first_efficiency" readonly="1" />

                                        </group>
                                        <group colspan="2" col="2">
                                            <field name="is_subtract_price_subproduct" />
                                        </group>
                                    </group>
                                    <group colspan="8" col="4" string="Cost history">
                                        <group colspan="4" col="4">
                                            <field name="bom_cost_history_ids" readonly="1" colspan="4" nolabel="1">
                                                <tree string="Cost history" editable="bottom" create="false">
                                                    <field name="date" />
                                                    <field name="currency_id" />
                                                    <field name="price_qty" />
                                                    <field name="price" />
                                                    <field name="routing_first_price" />
                                                    <field name="production_cost_price" />
                                                    <field name="user_id" />
                                                </tree>
                                            </field>
                                        </group>
                                    </group>
                                </page>
                                <!-- <page string="Child component complete"> -->
                                <!-- <field name="child_complete_ids" /> -->
                                <!-- <field name="child_structure_ids" invisible="1"/> -->
                                <!-- </page> -->
                            </notebook>
                        </group>
                        <group colspan="1" col="1" class="op_shortcuts">
                            <separator colspan="1" string="Actions" name="separator_actions_menu" />
                            <button name="action_compute_price" states="draft,active,obsolete" string="Compute price" type="object" class="oe_inline oe_stat_button" icon="fa-check" />
                            <separator colspan="1" string="Importation" attrs="{'invisible': ['|','|',('is_model', '!=', False),('bom_ids', '!=', []),('template_id', '=', False)]}" />
                            <button type="action" string="Importation component" name="%(act_importation_component_bom)d" attrs="{'invisible': ['|','|',('is_model', '!=', False),('bom_ids', '!=', []),('template_id', '=', False)]}" class="oe_inline oe_stat_button" icon="fa-check" />
                            <separator colspan="1" string="Analysis" name="separator_analysis_menu" />
                            <button name="%(action_structure_tree3)d" string="BoM structure" type="action" class="oe_inline oe_stat_button" icon="fa-check" />
                            <button name="%(action_wiz_cost_simulation)d" string="Cost simulation" type="action" class="oe_inline oe_stat_button" icon="fa-balance-scale" />
                            <button name="button_return_list_component_product" string="List products" type="object" class="oe_inline oe_stat_button" icon="fa-list" />
                        </group>
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Bom -->
        <record id='view_tree_mrp_bom' model='ir.ui.view'>
            <field name="name">view_tree_mrp_bom</field>
            <field name="model">mrp.bom</field>
            <field name="priority">1</field>
            <field name="arch" type="xml">
                <tree string="BoMs" version="8.0">
                    <field name="bom_id" invisible="context.get('component_view', True)" />
                    <field name="product_id" />
                    <field name="quantity" />
                    <field name="uom_id" />
                    <field name="type" />
                    <field name="start_date" />
                    <field name="stop_date" />
                    <field name="production_cost_price" />
                    <field name="routing_first_id" />
                    <field name="state" />
                </tree>
            </field>
        </record>

        <record id="mrp_bom_component_tree_view" model="ir.ui.view">
            <field name="name">mrp.bom.component.tree</field>
            <field name="model">mrp.bom</field>
            <field name="type">tree</field>
            <field name="priority">10</field>
            <field name="arch" type="xml">
                <tree string="BoM Structure">
                    <field name="sequence" />
                    <field name="bom_id" />
                    <field name="product_id" />
                    <field name="quantity" />
                    <field name="uom_id" />
                    <field name="type" />
                    <field name="start_date" />
                    <field name="stop_date" />
                    <field name="state" />
                </tree>
            </field>
        </record>



        <!-- SEARCH VIEW Bom -->
        <record id='view_search_mrp_bom' model='ir.ui.view'>
            <field name="name">view_search_mrp_bom</field>
            <field name="model">mrp.bom</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <group>
                        <field name="product_id" />
                        <field name="start_date" />
                        <field name="stop_date" />
                        <field name="state" />
                        <field name="routing_first_id" />
                    </group>
                    <newline />
                    <group expand="0" string="Group By...">
                        <filter string="Product" icon="terp-partner" context="{'group_by' : 'product_id'}" />
                        <separator orientation="vertical" />
                        <filter string="State" icon="terp-partner" context="{'group_by' : 'state'}" />
                        <separator orientation="vertical" />
                        <filter string="Routing first" icon="terp-partner" context="{'group_by' : 'routing_first_id'}" />
                    </group>
                </search>
            </field>
        </record>

        <!-- ACTION Bom -->
        <record id="act_mrp_bom" model="ir.actions.act_window">
            <field name="name">BoM</field>
            <field name="res_model">mrp.bom</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('bom_id','=',False)]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="view_search_mrp_bom" />
        </record>

        <record id="act_mrp_bom_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_bom" />
            <field name="act_window_id" ref="act_mrp_bom" />
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_bom_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_bom" />
            <field name="act_window_id" ref="act_mrp_bom" />
        </record>

        <!-- ACTION Composant -->
        <record id="act_mrp_component" model="ir.actions.act_window">
            <field name="name">Component</field>
            <field name="res_model">mrp.bom</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('bom_id','!=',False)]</field>
            <field name="context">{}</field>
        </record>

        <record id="act_mrp_component_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="mrp_bom_component_tree_view" />
            <field name="act_window_id" ref="act_mrp_component" />
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_component_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_bom" />
            <field name="act_window_id" ref="act_mrp_component" />
        </record>


        <!-- ACTION Structure -->
        <act_window name="Bom" res_model="mrp.see.bom" src_model="mrp.bom" view_mode="form" target="new" key2="tree_but_open" id="action_view_mrp_bom" />

        <record model="ir.actions.act_window" id="act_bill_of_materials_form">
            <field name="name">Bill of materials</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.bom</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <record id="ir_act_mrp_bom_open" model="ir.values">
            <field name="key2">tree_but_open</field>
            <field name="model">mrp.see.bom</field>
            <field name="name">Open BOM</field>
            <field eval="'ir.actions.act_window,%d'%action_view_mrp_bom" name="value" />
        </record>

        <!-- Menu -->
        <menuitem name="BoM" action="act_mrp_bom" id="menu_mrp_bom_bom" parent="menu_mrp_bom" sequence="10" groups="group_menu_bom_routing" />
        <menuitem name="Component" action="act_mrp_component" id="menu_mrp_bom_component" parent="menu_bom_conf" sequence="10" groups="base_openprod.group_menu_tech_data_config" />

        <record id='view_form_mrp_component_formula' model='ir.ui.view'>
            <field name="name">view_form_mrp_component_formula</field>
            <field name="model">mrp.bom</field>
            <field name="arch" type="xml">
                <form string="Formula component" version="8.0">
                    <group colspan="4" col="4">
                        <group colspan="4" col="8">
                            <group colspan="6" col="6" string="Information">
                                <h3>
                                    <p>
                                        You can put in the formula, parameterized and variables defined
                                        <br />
                                        - Qty component : qty_component
                                        <br />
                                        - Efficiency component : eff_component
                                        <br />
                                        - Qty bom: qty_bom
                                        <br />
                                        - Qty WO (default qty_bom) : qty_wo
                                        <br />
                                        Default parameter values are taken from the product file (Use in formula param['name of parameter'])
                                        <br />
                                        Example :
                                        <br />
                                        qty_component * 12 / 11 * qty_wo / eff_component / qty_bom
                                        <br />
                                        qty_component * param['width1'] / param['length1'] * qty_wo / eff_component +5
                                        <br />
                                        Is applied to the rounded result of the formula
                                        <br />
                                    </p>
                                </h3>
                            </group>
                            <group colspan="2" col="2" string="Param['']">
                                <field name="parameter_product_text" nolabel="1" readonly="1" />
                            </group>
                        </group>
                        <group colspan="4" col="4" string="formula qty">
                            <field name="formula_component" nolabel="1" colspan="4" />
                        </group>
                        <button name="action_return_true" string="Save" type="object" class="oe_inline oe_stat_button" icon="fa-check" colspan="1" />
                    </group>
                </form>
            </field>
        </record>

        <!-- ACTION Bom -->
        <record id="act_mrp_component_formula" model="ir.actions.act_window">
            <field name="name">Formula component</field>
            <field name="res_model">mrp.bom</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('bom_id','=',False)]</field>
            <field name="context">{}</field>
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_component_formula_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_component_formula" />
            <field name="act_window_id" ref="act_mrp_component_formula" />
        </record>



        <!-- ===================================== -->
        <!-- Replacing Components in all BOM -->
        <!-- ===================================== -->

        <!-- FORM VIEW Replacing Components in all BOMs -->
        <record id='view_form_mrp_bom_modif_component' model='ir.ui.view'>
            <field name="name">view_form_mrp_bom_modif_component</field>
            <field name="model">mrp.bom.modif.component</field>
            <field name="arch" type="xml">
                <form string="Components replacement" version="8.0">
                    <header>
                        <button name="wkf_validate" states="draft" string="Validate" type="object" class="oe_highlight" />
                        <field name="state" widget="statusbar" statusbar_visible="draft, validate" />
                    </header>
                    <group colspan="4" col="4">
                        <field name="name" attrs="{'readonly':[('state','=','validate')]}" />
                        <field name="reason" attrs="{'readonly':[('state','=','validate')]}" />
                        <field name="product_id" attrs="{'readonly':[('state','=','validate')]}" />
                        <field name="new_product_id" domain="[('uom_id','=',uom_id)]" attrs="{'readonly':[('state','=','validate')]}" />
                        <field name="user_id" attrs="{'readonly':[('state','=','validate')]}" />
                        <field name="uom_id" invisible="1" />
                    </group>
                    <field name="component_ids" colspan="1" nolabel="1" attrs="{'readonly':[('state','=','validate')]}">
                        <tree string="Components" version="8.0" create="false">
                            <field name="state_bom" />
                            <field name="bom_id" />
                            <field name="component_id" />
                            <field name="quantity" />
                            <field name="uom_id" />
                        </tree>
                        <from string="Components" version="8.0">
                            <field name="component_id" domain="[('bom_id','!=',False)]" />
                            <field name="bom_id" invisible="1" />
                            <field name="modif_component_id" invisible="1" />
                            <field name="state_bom" invisible="1" />
                            <field name="uom_id" invisible="1" />
                            <field name="quantity" invisible="1" />
                        </from>
                    </field>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Replacing Components in all BOMs -->
        <record id='view_tree_mrp_bom_modif_component' model='ir.ui.view'>
            <field name="name">view_tree_mrp_bom_modif_component</field>
            <field name="model">mrp.bom.modif.component</field>
            <field name="arch" type="xml">
                <tree string="Components replacement" version="8.0">
                    <field name="name" />
                    <field name="reason" />
                    <field name="product_id" />
                    <field name="new_product_id" />
                    <field name="user_id" />
                    <field name="state" />
                </tree>
            </field>
        </record>

        <!-- SEARCH VIEW Replacing Components in all BOMs -->
        <record id='view_search_mrp_bom_modif_component' model='ir.ui.view'>
            <field name="name">view_search_mrp_bom_modif_component</field>
            <field name="model">mrp.bom.modif.component</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <group>
                        <field name="product_id" />
                        <field name="new_product_id" />
                        <field name="user_id" />
                        <field name="name" />
                        <field name="reason" />
                    </group>
                    <newline />
                    <group expand="0" string="Group By...">
                        <filter string="Users" icon="terp-partner" context="{'group_by' : 'user_id'}" />
                    </group>
                </search>
            </field>
        </record>

        <!-- ACTION Replacing Components in all BOMs -->
        <record id="act_mrp_bom_modif_component" model="ir.actions.act_window">
            <field name="name">Components replacement</field>
            <field name="res_model">mrp.bom.modif.component</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="view_search_mrp_bom_modif_component" />
        </record>

        <!-- <record id="act_mrp_bom_modif_component_tree" model="ir.actions.act_window.view"> <field name="sequence" eval="10"/> <field name="view_mode">tree</field> <field name="view_id" ref="view_tree_mrp_bom_modif_component"/> <field name="act_window_id" ref="act_mrp_bom_modif_component"/> </record> <record model="ir.actions.act_window.view" id="act_mrp_bom_modif_component_form"> <field name="sequence" eval="20"/> <field name="view_mode">form</field> <field name="view_id" ref="view_from_mrp_bom_modif_component"/> <field name="act_window_id" ref="act_mrp_bom_modif_component"/> </record> -->

        <menuitem name="Components replacement" action="act_mrp_bom_modif_component" id="menu_mrp_bom_modif_component" parent="menu_mrp_bom" sequence="30" groups="group_menu_bom_routing" />


        <!-- ============= -->
        <!-- ATELIER -->
        <!-- ============= -->

        <!-- FORM VIEW Area -->
        <record id='view_form_mrp_area' model='ir.ui.view'>
            <field name="name">view_form_mrp_area</field>
            <field name="model">mrp.area</field>
            <field name="arch" type="xml">
                <form string="Area" version="8.0">
                    <group colspan="4" col="4" string="Area">
                        <field name="name" />
                        <field name="company_id" />
                        <field name="active" />
                        <label for="description" string="Description" colspan="4" />
                        <field name="description" nolabel="1" colspan="4" />
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Area -->
        <record id='view_tree_mrp_area' model='ir.ui.view'>
            <field name="name">view_tree_mrp_area</field>
            <field name="model">mrp.area</field>
            <field name="arch" type="xml">
                <tree string="Areas" version="8.0">
                    <field name="name" />
                    <field name="company_id" />
                    <field name="active" />
                </tree>
            </field>
        </record>

        <!-- SEARCH VIEW Area -->
        <record id='view_search_mrp_area' model='ir.ui.view'>
            <field name="name">view_search_mrp_area</field>
            <field name="model">mrp.area</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <group>
                        <field name="name" />
                    </group>
                    <newline />
                    <group expand="0" string="Group By...">
                    </group>
                </search>
            </field>
        </record>

        <!-- ACTION Area -->
        <record id="act_mrp_area" model="ir.actions.act_window">
            <field name="name">Area</field>
            <field name="res_model">mrp.area</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="view_search_mrp_area" />
        </record>

        <record id="act_mrp_area_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_area" />
            <field name="act_window_id" ref="act_mrp_area" />
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_area_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_area" />
            <field name="act_window_id" ref="act_mrp_area" />
        </record>

        <menuitem name="Area" action="act_mrp_area" id="menu_mrp_conf_area" parent="menu_routing_conf" sequence="30" groups="base_openprod.group_menu_tech_data_config" />


        <!-- ================== -->
        <!-- BoM Revision -->
        <!-- ================== -->

        <!-- FORM VIEW BoM Revision -->
        <record id='view_form_mrp_bom_revision' model='ir.ui.view'>
            <field name="name">view_form_mrp_bom_revision</field>
            <field name="model">mrp.bom.revision</field>
            <field name="arch" type="xml">
                <form string="Bill of Material Revision" version="8.0">
                    <group colspan="4" col="4" string="Revision">
                        <field name="indice" />
                        <field name="name" />
                        <field name="last_indice" />
                        <field name="author_id" />
                        <field name="date" />
                        <group colspan="4" col="4" string="Desciption">
                            <field name="desciption" colspan="4" nolabel="1" />
                        </group>
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW BoM Revision -->
        <record id='view_tree_mrp_bom_revision' model='ir.ui.view'>
            <field name="name">view_tree_mrp_bom_revision</field>
            <field name="model">mrp.bom.revision</field>
            <field name="arch" type="xml">
                <tree string="Bill of Material Revision" version="8.0">
                    <field name="name" />
                    <field name="desciption" />
                    <field name="date" />
                    <field name="indice" />
                    <field name="last_indice" />
                    <field name="author_id" />
                </tree>
            </field>
        </record>

        <!-- ACTION BoM Revision -->
        <record id="act_mrp_bom_revision" model="ir.actions.act_window">
            <field name="name">Bill of Material Revision</field>
            <field name="res_model">mrp.bom.revision</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
        </record>


        <!-- ================ -->
        <!-- Ressources -->
        <!-- ================ -->

        <!-- FORM VIEW Resource -->
        <record id='mrp_view_form_mrp_resource_mrp' model='ir.ui.view'>
            <field name="name">mrp_view_form_mrp_resource_mrp</field>
            <field name="model">mrp.resource</field>
            <field name="inherit_id" ref="stock_location.view_form_mrp_resource_stock_location" />
            <field name="priority" eval="1400" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='location_id']" position="after">
                    <field name="area_id" attrs="{'required':[('type', '!=', 'human')]}" />
                </xpath>
                <xpath expr="//field[@name='stop_date']" position="after">
                    <field name="limit_loading" />
                </xpath>
            </field>
        </record>

        <!-- TREE VIEW Resource -->
        <record id='mrp_view_tree_mrp_resource_mrp' model='ir.ui.view'>
            <field name="name">mrp_view_tree_mrp_resource_mrp</field>
            <field name="model">mrp.resource</field>
            <field name="inherit_id" ref="stock_location.view_tree_mrp_resource_stock_location" />
            <field name="priority" eval="1400" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='location_id']" position="after">
                    <field name="area_id" attrs="{'required':[('type', '!=', 'human')]}" />
                </xpath>
            </field>
        </record>

        <!-- ============ -->
        <!-- Gammes -->
        <!-- ============ -->

        <!-- FORM VIEW Routing -->
        <record id='view_form_mrp_routing' model='ir.ui.view'>
            <field name="name">view_form_mrp_routing</field>
            <field name="model">mrp.routing</field>
            <field name="arch" type="xml">
                <form string="Routing" version="8.0">
                    <header>
                        <button name="wkf_draft" states="obsolete" string="Draft" type="object" class="oe_highlight" />
                        <button name="wkf_active" states="draft" string="Active" type="object" class="oe_highlight" />
                        <button name="wkf_obsolete" states="draft,active" string="Obsolete" type="object" class="oe_highlight" />
                        <field name="state" widget="statusbar" statusbar_visible="draft, active, obsolete" />
                    </header>
                    <group colspan="4" col="9">
                        <group colspan="8" attrs="{'readonly': [('state', '!=', 'draft')]}">
                            <group colspan="8" col="4">
                                <group colspan="4" col="6">
                                    <group colspan="2" col="2">
                                        <field name="name" />
                                        <field name="start_date" />
                                        <field name="price_qty" />
                                    </group>
                                    <group colspan="2" col="2">
                                        <field name="reference" />
                                        <field name="stop_date" />
                                        <field name="option_id" />
                                        <field name="bom_first_id" invisible="1" />
                                    </group>
                                    <group colspan="2" col="2">
                                        <field name="is_model" string="Is model" attrs="{'invisible': [('template_id', '!=', False)]}" />
                                        <field name="template_id" attrs="{'invisible': [('is_model', '!=', False)],'readonly': [('routing_line_ids', '!=', [])]}" domain="[('is_model','=',True)]" context="{'default_is_model': True}" />
                                        <field name="bom_first_uom_id" invisible="1" />
                                    </group>
                                </group>
                                <notebook colspan="4">
                                    <page string="Routing lines">
                                        <field name="max_sequence" invisible="1" />
                                        <field name="routing_line_ids" nolabel="1" colspan="4" context="{'default_sequence':max_sequence, 'default_routing_state':state}" />
                                    </page>
                                    <page string="BoM">
                                        <field name="bom_ids" nolabel="1" colspan="4" domain="[('bom_id','=',False)]">
                                            <tree string="BoMs" version="8.0">
                                                <field name="product_id" />
                                                <field name="quantity" />
                                                <field name="uom_id" />
                                                <field name="type" />
                                                <field name="start_date" />
                                                <field name="stop_date" />
                                                <field name="state" />
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Declension" attrs="{'invisible': [('is_model', '!=', True)]}">
                                        <field name="template_ids" nolabel="1" colspan="4" readonly="1" />
                                    </page>
                                    <page string="Operations consumed">
                                        <group colspan="4" col="4">
                                            <field name="operation_consumed_ids" nolabel="1" colspan="4">
                                                <tree string="Components" editable="bottom">
                                                    <field name="operation_id" domain="[('routing_id','=',parent.id),('id','!=',operation_consumed_id)]" options="{'no_create': True}" required="1" />
                                                    <field name="operation_consumed_id" domain="[('routing_id','=',parent.id),('id','!=',operation_id)]" options="{'no_create': True}" required="1" />
                                                </tree>
                                            </field>
                                        </group>
                                        <field name="consumed_component_ids" nolabel="1" colspan="4" invisible="0">
                                            <tree string="BoM Structure">
                                                <field name="sequence" invisible="1" />
                                                <field name="bom_id" />
                                                <field name="product_id" />
                                                <field name="quantity" />
                                                <field name="uom_id" />
                                                <field name="type" />
                                                <field name="start_date" />
                                                <field name="stop_date" />
                                                <field name="state" />
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Cost">
                                        <group colspan="4" col="6" String="Cost">
                                            <group colspan="2" col="2">
                                                <field name="total_price" readonly="1" />
                                                <field name="price_unit" readonly="1" />
                                                <field name="bom_first_price" invisible="1" />
                                            </group>
                                            <group colspan="2" col="2">
                                                <field name="price_last_date" readonly="1" />
                                                <field name="company_id" />
                                            </group>
                                            <group colspan="2" col="2">
                                                <field name="efficiency_global" />
                                            </group>
                                        </group>
                                        <group colspan="4" col="4" string="Cost history">
                                            <field name="routing_cost_history_ids" readonly="1" colspan="4" nolabel="1">
                                                <tree string="Cost history" editable="bottom" create="false">
                                                    <field name="date" />
                                                    <field name="currency_id" />
                                                    <field name="price_qty" />
                                                    <field name="price" />
                                                    <field name="user_id" />
                                                </tree>
                                            </field>
                                        </group>
                                    </page>
                                    <page string="Notes">
                                        <group colspan="4" col="6" string="Note on MO">
                                            <field name="note_mo" nolabel="1" colspan="4" />
                                        </group>
                                    </page>
                                </notebook>
                            </group>
                        </group>
                        <group colspan="1" col="1" class="op_shortcuts">
                            <separator colspan="1" string="Actions" name="separator_actions_menu" />
                            <separator colspan="1" string="Importation" attrs="{'invisible': ['|','|',('is_model', '!=', False),('routing_line_ids', '!=', []),('template_id', '=', False)]}" />
                            <button type="action" string="Importation routing line" name="%(act_importation_routing_line)d" attrs="{'invisible': ['|','|',('is_model', '!=', False),('routing_line_ids', '!=', []),('template_id', '=', False)]}" class="oe_inline oe_stat_button" icon="fa-check" />
                            <button name="action_compute_price" states="draft,active,obsolete" string="Compute price" type="object" class="oe_inline oe_stat_button" icon="fa-check" />
                            <button name="boutton_generate_op_cons" string="Generate operation consumed" type="object" class="oe_inline oe_stat_button" icon="fa-refresh" />
                            <button name="boutton_delete_op_cons" string="Delete operation consumed" type="object" class="oe_inline oe_stat_button" icon="fa-times" />
                        </group>
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Routing -->
        <record id='view_tree_mrp_routing' model='ir.ui.view'>
            <field name="name">view_tree_mrp_routing</field>
            <field name="model">mrp.routing</field>
            <field name="arch" type="xml">
                <tree string="Routings" version="8.0">
                    <field name="sequence" invisible="context.get('view_sequence', True)" />
                    <field name="reference" />
                    <field name="name" />
                    <field name="start_date" />
                    <field name="stop_date" />
                    <field name="total_price" />
                    <field name="option_id" />
                    <field name="bom_first_id" />
                    <field name="state" />
                </tree>
            </field>
        </record>

        <!-- SEARCH VIEW Routing -->
        <record id='view_search_mrp_routing' model='ir.ui.view'>
            <field name="name">view_search_mrp_routing</field>
            <field name="model">mrp.routing</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <group>
                        <field name="reference" />
                        <field name="name" />
                        <field name="start_date" />
                        <field name="stop_date" />
                        <field name="bom_first_id" />
                        <field name="state" />
                    </group>
                    <newline />
                    <group expand="0" string="Group By...">
                        <filter string="State" icon="terp-partner" context="{'group_by' : 'state'}" />
                        <separator orientation="vertical" />
                        <filter string="Bom first" icon="terp-partner" context="{'group_by' : 'bom_first_id'}" />
                    </group>
                </search>
            </field>
        </record>

        <!-- ACTION Routing -->
        <record id="act_mrp_routing" model="ir.actions.act_window">
            <field name="name">Routing</field>
            <field name="res_model">mrp.routing</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="view_search_mrp_routing" />
        </record>

        <record id="act_mrp_routing_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_routing" />
            <field name="act_window_id" ref="act_mrp_routing" />
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_routing_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_routing" />
            <field name="act_window_id" ref="act_mrp_routing" />
        </record>

        <!-- ACTION Routing see tree -->
        <record model="ir.actions.act_window" id="action_see_all_routing">
            <field name="name">Routing</field>
            <field name="res_model">mrp.routing</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="view_tree_mrp_routing" />
            <field name="view_mode">tree,form</field>
            <field name="target">current</field>
        </record>

        <menuitem name="Routing" action="act_mrp_routing" id="menu_mrp_routing_routing" parent="menu_mrp_routing" sequence="10" groups="group_menu_bom_routing" />



        <!-- ====================== -->
        <!-- Lignes de gammes -->
        <!-- ====================== -->

        <!-- FORM VIEW Simple Operations -->
        <record id='view_form_mrp_routing_line_simple' model='ir.ui.view'>
            <field name="name">view_form_mrp_routing_line_simple</field>
            <field name="model">mrp.routing.line</field>
            <field name="priority">10</field>
            <field name="arch" type="xml">
                <form string="Operations" version="8.0">
                    <group colspan="4" col="6" attrs="{'readonly': [('routing_state', '!=', 'draft')]}" name="group_head_operations">
                        <group colspan="2" col="2">
                            <field name="name" />
                            <field name="preparation_time" widget="float_time_seconds" />
                            <field name="routing_state" invisible="1" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="sequence" />
                            <field name="production_time" widget="float_time_seconds" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="product_id" domain="[('is_int','=',True)]" />
                            <field name="is_supplier_delay_subc" />
                        </group>
                    </group>
                    <field name="cleaning_time" invisible="1" />
                    <field name="is_forecast_time" invisible="1" />
                    <field name="nb_product_parallel" invisible="1" />
                    <field name="waiting_time_next_ope" invisible="1" />
                    <field name="percentage_overlap_next_ope" invisible="1" />
                    <field name="option_id" invisible="1" />
                    <field name="total_cost" invisible="1" />
                    <field name="efficiency" invisible="1" />
                    <field name="max_sequence_category" invisible="1" />
                    <notebook colspan="4">
                        <page string="Resource Category" autofocus="autofocus" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="is_line_category" invisible="1" />
                            <field name="rl_resource_category_ids" nolabel="1" colspan="4" mode="kanban" context="{'is_line_category':is_line_category, 'default_sequence':max_sequence_category}">
                                <form string="Category resources" version="8.0">
                                    <group colspan="4" col="6">
                                        <group colspan="2" col="2">
                                            <field name="sequence" invisible="1" />
                                            <field name="category_id" />
                                            <field name="type" />
                                            <field name="color_kanban" invisible="1" />
                                            <field name="preparation_time" widget="float_time_seconds" />
                                            <field name="production_time_seizure" widget="float_time_seconds" attrs="{'invisible':[('type', '!=', 'time')], 'required':[('type', '=', 'time')]}" />
                                            <field name="cadence" attrs="{'invisible':[('type', '!=', 'cadence')], 'required':[('type', '=', 'cadence')]}" />
                                            <field name="formula" attrs="{'invisible':[('type', '!=', 'formula')], 'required':[('type', '=', 'formula')]}" />
                                            <field name="nb_resource" />
                                            <field name="resource_ids" invisible="1" />
                                        </group>
                                        <group colspan="2" col="2">
                                            <field name="cleaning_time" invisible="1" />
                                        </group>
                                        <group colspan="2" col="2">
                                            <field name="preparation_masked_time" invisible="1" />
                                            <field name="production_masked_time" invisible="1" />
                                            <field name="cleaning_masked_time" invisible="1" />
                                        </group>
                                    </group>
                                    <group colspan="4" col="6" string="Resources">
                                        <field name="max_sequence_resource" invisible="1" />
                                        <field name="rl_resource_ids" nolabel="1" colspan="4" context="{'default_sequence':max_sequence_resource, 'default_category_id':category_id}">
                                            <tree string="Resources" version="8.0" editable="bottom">
                                                <field name="sequence" invisible="1" />
                                                <field name="category_id" invisible="1" />
                                                <field name="resource_id" domain="[('double_resource', 'not in', parent.resource_ids),('category_resource_ids','=',category_id)]" />
                                                <field name="preparation_time" invisible="1" />
                                                <field name="production_time" invisible="1" />
                                                <field name="cleaning_time" invisible="1" />
                                                <field name="preparation_masked_time" invisible="1" />
                                                <field name="production_masked_time" invisible="1" />
                                                <field name="cleaning_masked_time" invisible="1" />
                                            </tree>
                                        </field>
                                    </group>
                                </form>
                                <kanban string="Category resources">
                                    <field name="sequence" />
                                    <field name="category_id" />
                                    <field name="preparation_time" />
                                    <field name="production_time" />
                                    <field name="resource_ids" />
                                    <field name="rl_resource_ids" nolabel="1" colspan="4" context="{'default_sequence':max_sequence_resource}">
                                        <tree string="Resources" version="8.0">
                                            <field name="resource_id" />
                                        </tree>
                                    </field>
                                    <templates>

                                        <t t-name="kanban-box">
                                            <div t-attf-class="oe_kanban_color_#{kanban_getcolor(record.color_kanban.raw_value)} oe_kanban_card oe_kanban_global_click oe_semantic_html_override">
                                                <a t-if="! read_only_mode" type="delete" style="position: relative; left: 0; padding: 4px; diplay: inline-block" class="pull-right">X</a>
                                                <div class="oe_dropdown_toggle oe_dropdown_kanban" groups="base.group_user">
                                                    <ul class="oe_dropdown_menu">
                                                        <li>
                                                            <ul class="oe_kanban_colorpicker" data-field="color_kanban" />
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="oe_kanban_content" tooltip="kanban-tooltip">
                                                    <table class="oe_kanban_table">
                                                        <tr>
                                                            <td class="oe_kanban_title1" align="left" valign="middle">
                                                                <h4>
                                                                    <a type="open">
                                                                        <div>
                                                                            Category:
                                                                            <field name="category_id" />
                                                                        </div>
                                                                    </a>
                                                                </h4>
                                                                <div>
                                                                    <b>Preparation time : </b>
                                                                    <field name="preparation_time" widget="float_time_seconds" />
                                                                </div>
                                                                <div>
                                                                    <b>Production time : </b>
                                                                    <field name="production_time" widget="float_time_seconds" />
                                                                </div>
                                                                <div>
                                                                    <b>Resources :</b>
                                                                    <field name="concat_resource" />
                                                                </div>
                                                                <field name="color_kanban" invisible="1" />
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <div class="oe_clear"></div>
                                            </div>
                                        </t>
                                    </templates>
                                </kanban>
                            </field>
                        </page>
                        <page string="Consumed Component" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="consumed_component_ids" nolabel="1" colspan="4" domain="[('bom_id_in_routing','in',parent.bom_ids),('bom_id_already_use','not in',parent.consumed_component_ids)]" context="{'component_view': False, 'value_parent': parent}">
                                <tree string="Consumed Component" context="{'component_view': False}">
                                    <field name="sequence" invisible="1" />
                                    <field name="bom_id" />
                                    <field name="product_id" />
                                    <field name="quantity" />
                                    <field name="uom_id" />
                                    <field name="type" />
                                    <field name="start_date" />
                                    <field name="stop_date" />
                                    <field name="state" />
                                </tree>
                            </field>
                        </page>
                        <page string="Consumed Service" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="consumed_service_ids" nolabel="1" colspan="4">
                                <tree string="Components" editable="bottom">
                                    <field name="product_id" domain="[('type','=','service'), ('manage_service_receipt', '=', True)]" />
                                    <field name="quantity" />
                                    <field name="uom_id" domain="[('category_id','=',uom_category_id)]" />
                                    <field name="uom_category_id" invisible="1" />
                                    <field name="type" />
                                    <field name="price_total" />
                                </tree>
                            </field>
                        </page>
                        <page string="Tools" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="tool_ids" nolabel="1" colspan="4">
                                <tree string="Components" editable="bottom">
                                    <field name="product_id" domain="[('type','=','tech_tool')]" context="{'default_type': 'tech_tool'}" />
                                    <field name="quantity" />
                                    <field name="uom_id" domain="[('category_id','=',uom_category_id)]" />
                                    <field name="uom_category_id" invisible="1" />
                                </tree>
                            </field>
                        </page>
                        <page string="Complaints" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="complaint_ids" nolabel="1" colspan="4" />
                        </page>
                        <page string="Documents" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="document_ids" nolabel="1" colspan="4" />
                        </page>
                        <page string="Consigns" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="consign_ids" nolabel="1" colspan="4">
                                <tree string="Consigns" editable="bottom">
                                    <field name="name" />
                                    <field name="frequency" />
                                    <field name="type" invisible="1" />
                                    <field name="desciptive" />
                                    <field name="means" />
                                </tree>
                            </field>
                        </page>
                        <page string="Controls" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <group colspan="4" col="4">
                                <group string="Plan of Control" colspan="2" col="2">
                                    <field name="quality_control_ids" colspan="2" nolabel="1" context="{'default_type': 'intern'}">
                                        <tree editable="bottom" string="Controls">
                                            <field name="type" invisible="1" />
                                            <field name="control_id" domain="[('type', '=', type)]" context="{'default_type': type}" />
                                            <field name="partner_id" />
                                        </tree>
                                    </field>
                                </group>
                            </group>
                        </page>
                        <page string="Cost history">
                            <group colspan="4" col="4" string="Cost history">
                                <field name="rl_cost_history_ids" readonly="1" colspan="4" nolabel="1">
                                    <tree string="Cost history" editable="bottom" create="false">
                                        <field name="date" />
                                        <field name="currency_id" />
                                        <field name="price_qty" />
                                        <field name="price" />
                                        <field name="user_id" />
                                    </tree>
                                </field>
                            </group>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>


        <!-- FORM VIEW Operations -->
        <record id='view_form_mrp_routing_line' model='ir.ui.view'>
            <field name="name">view_form_mrp_routing_line</field>
            <field name="model">mrp.routing.line</field>
            <field name="priority">100</field>
            <field name="arch" type="xml">
                <form string="Operations" version="8.0">
                    <group colspan="4" col="6" attrs="{'readonly': [('routing_state', '!=', 'draft')]}" name="group_head_operations">
                        <group colspan="2" col="2">
                            <field name="sequence" />
                            <field name="name" />
                            <field name="product_id" domain="[('is_int','=',True)]" />
                            <field name="nb_product_parallel" />
                            <field name="routing_state" invisible="1" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="waiting_time_next_ope" />
                            <field name="percentage_overlap_next_ope" />
                            <field name="option_id" groups="mrp.mrp_options" />
                            <field name="total_cost" />
                            <field name="efficiency" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="preparation_time" widget="float_time_seconds" />
                            <field name="production_time" widget="float_time_seconds" />
                            <field name="cleaning_time" widget="float_time_seconds" />
                            <field name="is_forecast_time" />
                            <field name="is_supplier_delay_subc" />
                            <field name="routing_id" invisible="1" />
                        </group>
                    </group>
                    <notebook colspan="4">
                        <page string="Resource Category" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="max_sequence_category" invisible="1" />
                            <field name="is_line_category" invisible="1" />
                            <field name="rl_resource_category_ids" nolabel="1" colspan="4" context="{'is_line_category':is_line_category,'default_sequence':max_sequence_category}" />
                        </page>
                        <page string="Consumed Component" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="consumed_component_ids" nolabel="1" colspan="4" domain="[('bom_id_in_routing1','in', routing_id),('bom_id_already_use1','not in', routing_id)]" context="{'component_view': False}">
                                <tree string="Consumed Component" context="{'component_view': False}">
                                    <field name="sequence" invisible="1" />
                                    <field name="bom_id" />
                                    <field name="product_id" />
                                    <field name="quantity" />
                                    <field name="uom_id" />
                                    <field name="type" />
                                    <field name="start_date" />
                                    <field name="stop_date" />
                                    <field name="state" />
                                </tree>
                            </field>
                        </page>
                        <page string="Consumed Service" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="consumed_service_ids" nolabel="1" colspan="4">
                                <tree string="Components" editable="bottom">
                                    <field name="product_id" domain="[('type','=','service'), ('manage_service_receipt', '=', True)]" />
                                    <field name="quantity" />
                                    <field name="uom_id" domain="[('category_id','=',uom_category_id)]" />
                                    <field name="uom_category_id" invisible="1" />
                                    <field name="type" />
                                </tree>
                            </field>
                        </page>
                        <page string="Tools" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="tool_ids" nolabel="1" colspan="4">
                                <tree string="Components" editable="bottom">
                                    <field name="product_id" domain="[('type','=','tech_tool')]" context="{'default_type': 'tech_tool'}" />
                                    <field name="quantity" />
                                    <field name="uom_id" domain="[('category_id','=',uom_category_id)]" />
                                    <field name="uom_category_id" invisible="1" />
                                </tree>
                            </field>
                        </page>
                        <page string="Complaints" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="complaint_ids" nolabel="1" colspan="4" />
                        </page>
                        <page string="Documents" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="document_ids" nolabel="1" colspan="4" />
                        </page>
                        <page string="Consigns" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="consign_ids" nolabel="1" colspan="4">
                                <tree string="Consigns" editable="bottom">
                                    <field name="name" />
                                    <field name="frequency" />
                                    <field name="type" invisible="1" />
                                    <field name="desciptive" />
                                    <field name="means" />
                                </tree>
                            </field>
                        </page>
                        <page string="Controls" attrs="{'readonly': [('routing_state', '!=', 'draft')]}">
                            <field name="quality_control_ids" colspan="4" nolabel="1" context="{'default_type': 'intern'}">
                                <tree editable="bottom" string="Controls">
                                    <field name="type" invisible="1" />
                                    <field name="control_id" domain="[('type', '=', type)]" context="{'default_type': type}" />
                                    <field name="partner_id" />
                                </tree>
                            </field>
                        </page>
                        <page string="Cost history">
                            <group colspan="4" col="4" string="Cost history">
                                <field name="rl_cost_history_ids" readonly="1" colspan="4" nolabel="1">
                                    <tree string="Cost history" editable="bottom" create="false">
                                        <field name="date" />
                                        <field name="currency_id" />
                                        <field name="price_qty" />
                                        <field name="price" />
                                        <field name="user_id" />
                                    </tree>
                                </field>
                            </group>
                        </page>
                    </notebook>
                    <button name="button_save_true" string="Save" type="object" invisible="context.get('button_save', True)" />
                </form>
            </field>
        </record>

        <!-- TREE VIEW Operations -->
        <record id='view_tree_mrp_routing_line' model='ir.ui.view'>
            <field name="name">view_tree_mrp_routing_line</field>
            <field name="model">mrp.routing.line</field>
            <field name="arch" type="xml">
                <tree string="Operations" version="8.0">
                    <button name="button_line_complete" string="Complete line" type="object" icon="terp-tools" context="{'button_save': False}" />
                    <field name="sequence" />
                    <field name="name" />
                    <field name="first_category_id" invisible="1" />
                    <field name="first_resource_id" />
                    <field name="preparation_time" widget="float_time_seconds" sum="sum_preparation_time" />
                    <field name="production_time" widget="float_time_seconds" sum="sum_production_time" />
                    <field name="cleaning_time" widget="float_time_seconds" sum="sum_cleaning_time" />
                    <field name="total_time_unit" widget="float_time_seconds" sum="sum_total_time" />
                    <field name="option_id" groups="mrp.mrp_options" />
                    <field name="total_cost" />
                </tree>
            </field>
        </record>

        <!-- SEARCH VIEW Operations -->
        <record id='view_search_mrp_routing_line' model='ir.ui.view'>
            <field name="name">view_search_mrp_routing_line</field>
            <field name="model">mrp.routing.line</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <group>
                        <field name="routing_id" />
                        <field name="first_category_id" />
                        <field name="first_resource_id" />
                    </group>
                    <newline />
                    <group expand="0" string="Group By...">
                    </group>
                </search>
            </field>
        </record>

        <!-- ACTION Simple Operations -->
        <record id="act_mrp_routing_line" model="ir.actions.act_window">
            <field name="name">Operations</field>
            <field name="res_model">mrp.routing.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="view_search_mrp_routing_line" />
        </record>

        <record id="act_mrp_routing_line_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_routing_line" />
            <field name="act_window_id" ref="act_mrp_routing_line" />
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_routing_line_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_routing_line_simple" />
            <field name="act_window_id" ref="act_mrp_routing_line" />
        </record>


        <!-- ACTION Operations -->
        <record id="act_mrp_routing_line_complete" model="ir.actions.act_window">
            <field name="name">Operations</field>
            <field name="res_model">mrp.routing.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="view_search_mrp_routing_line" />
        </record>

        <record id="act_mrp_routing_line_complete_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_routing_line" />
            <field name="act_window_id" ref="act_mrp_routing_line_complete" />
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_routing_line_complete_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_routing_line" />
            <field name="act_window_id" ref="act_mrp_routing_line_complete" />
        </record>

        <menuitem name="Operations completes" action="act_mrp_routing_line_complete" id="menu_mrp_routing_line" parent="menu_routing_conf" sequence="20" groups="base_openprod.group_menu_tech_data_config" />

        <!-- ACTION Operations -->
        <record model="ir.actions.act_window" id="act_mrp_routing_line_complete_button">
            <field name="name">Operations</field>
            <field name="res_model">mrp.routing.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_routing_line" />
            <field name="target">new</field>
        </record>

        <!-- ============================================ -->
        <!-- Ressources catégories lignes de gammes -->
        <!-- ============================================ -->

        <!-- FORM VIEW Resource category -->
        <record id='view_form_mrp_rl_resource_category' model='ir.ui.view'>
            <field name="name">view_form_mrp_rl_resource_category</field>
            <field name="model">mrp.rl.resource.category</field>
            <field name="arch" type="xml">
                <form string="Category resources" version="8.0">
                    <group colspan="4" col="6" name="group_name_head">
                        <group colspan="2" col="2">
                            <field name="sequence" />
                            <field name="type" />
                            <field name="category_id" />
                            <field name="nb_resource" />
                            <field name="color_kanban" invisible="1" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="preparation_time" widget="float_time_seconds" />
                            <field name="production_time_seizure" widget="float_time_seconds" attrs="{'invisible':[('type', '!=', 'time')], 'required':[('type', '=', 'time')]}" />
                            <field name="cadence" attrs="{'invisible':[('type', '!=', 'cadence')], 'required':[('type', '=', 'cadence')]}" />
                            <field name="formula" attrs="{'invisible':[('type', '!=', 'formula')], 'required':[('type', '=', 'formula')]}" />
                            <field name="production_time" widget="float_time_seconds" attrs="{'invisible':[('type', '=', 'time')]}" />
                            <field name="cleaning_time" widget="float_time_seconds" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="preparation_masked_time" />
                            <field name="production_masked_time" />
                            <field name="cleaning_masked_time" />
                        </group>
                    </group>
                    <notebook colspan="4">
                        <page string="Resources">
                            <field name="max_sequence_resource" invisible="1" />
                            <field name="resource_ids" invisible="1" />
                            <field name="rl_resource_ids" nolabel="1" colspan="4" context="{'default_sequence':max_sequence_resource, 'default_category_id':category_id}">
                                <form string="Resources">
                                    <group colspan="4" col="6">
                                        <group colspan="2" col="2">
                                            <field name="sequence" />
                                            <field name="category_id" invisible="1" />
                                            <field name="type" />
                                            <field name="resource_id" domain="[('double_resource', 'not in', parent.resource_ids),('category_resource_ids','=',category_id)]" />
                                        </group>
                                        <group colspan="2" col="2">
                                            <field name="preparation_time" widget="float_time_seconds" />
                                            <field name="production_time_seizure" widget="float_time_seconds" attrs="{'invisible':[('type', '!=', 'time')]}" />
                                            <field name="cadence" attrs="{'invisible':[('type', '!=', 'cadence')]}" />
                                            <field name="formula" attrs="{'invisible':[('type', '!=', 'formula')]}" />
                                            <field name="cleaning_time" widget="float_time_seconds" />
                                        </group>
                                        <group colspan="2" col="2">
                                            <field name="preparation_masked_time" />
                                            <field name="production_masked_time" />
                                            <field name="cleaning_masked_time" />
                                        </group>
                                    </group>
                                </form>
                                <tree string="Resourcess">
                                    <field name="sequence" />
                                    <field name="resource_id" />
                                    <field name="preparation_time" widget="float_time_seconds" />
                                    <field name="preparation_masked_time" />
                                    <field name="production_time" widget="float_time_seconds" />
                                    <field name="production_masked_time" />
                                    <field name="cleaning_time" widget="float_time_seconds" />
                                    <field name="cleaning_masked_time" />
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Resource category -->
        <record id='view_tree_mrp_rl_resource_category' model='ir.ui.view'>
            <field name="name">view_tree_mrp_rl_resource_category</field>
            <field name="model">mrp.rl.resource.category</field>
            <field name="arch" type="xml">
                <tree string="Category resources" version="8.0">
                    <field name="sequence" />
                    <field name="category_id" />
                    <field name="preparation_time" widget="float_time_seconds" />
                    <field name="preparation_masked_time" />
                    <field name="production_time" widget="float_time_seconds" />
                    <field name="production_masked_time" />
                    <field name="cleaning_time" widget="float_time_seconds" />
                    <field name="cleaning_masked_time" />
                    <field name="color_kanban" invisible="1" />
                </tree>
            </field>
        </record>

        <!-- ================================= -->
        <!-- Ressources lignes de gammes -->
        <!-- ================================= -->

        <!-- FORM VIEW Resources -->
        <record id='view_form_mrp_rl_resource' model='ir.ui.view'>
            <field name="name">view_form_mrp_rl_resource</field>
            <field name="model">mrp.rl.resource</field>
            <field name="arch" type="xml">
                <form string="Resources" version="8.0">
                    <group colspan="4" col="6">
                        <group colspan="2" col="2">
                            <field name="sequence" />
                            <field name="category_id" />
                            <field name="resource_id" domain="('category_resource_ids','=',category_id)" />
                            <field name="category_id" invsible="1" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="preparation_time" widget="float_time_seconds" />
                            <field name="production_time" widget="float_time_seconds" />
                            <field name="cleaning_time" widget="float_time_seconds" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="preparation_masked_time" />
                            <field name="production_masked_time" />
                            <field name="cleaning_masked_time" />
                        </group>
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Resources -->
        <record id='view_tree_mrp_rl_resource' model='ir.ui.view'>
            <field name="name">view_tree_mrp_rl_resource</field>
            <field name="model">mrp.rl.resource</field>
            <field name="arch" type="xml">
                <tree string="Resourcess" version="8.0">
                    <field name="sequence" />
                    <field name="resource_id" />
                    <field name="preparation_time" widget="float_time_seconds" />
                    <field name="preparation_masked_time" />
                    <field name="production_time" widget="float_time_seconds" />
                    <field name="production_masked_time" />
                    <field name="cleaning_time" widget="float_time_seconds" />
                    <field name="cleaning_masked_time" />
                </tree>
            </field>
        </record>


        <!-- =========== -->
        <!-- Réclamation -->
        <!-- =========== -->
        <!-- FORM VIEW Complaints -->
        <record id='view_form_mrp_rl_complaint' model='ir.ui.view'>
            <field name="name">view_form_mrp_rl_complaint</field>
            <field name="model">mrp.rl.complaint</field>
            <field name="arch" type="xml">
                <form string="Complaints" version="8.0">
                    <group colspan="4" col="9">
                        <group colspan="8" col="4">
                            <group colspan="4" col="4" string="Informations">
                                <group colspan="2" col="2">
                                    <field name="name" />
                                    <field name="product_id" colspan="2" />
                                    <field name="customer_id" colspan="2" attrs="{'required': [('type', '=', 'customer')]}" />
                                </group>
                                <group colspan="2" col="2">
                                    <field name="type" />
                                    <field name="date" />
                                    <field name="area_id" />
                                </group>
                                <field name="motif" colspan="4" />
                                <group colspan="2" col="2" string="Cause">
                                    <field name="cause" nolabel="1" colspan="2" />
                                </group>
                                <group colspan="2" col="2" string="Action">
                                    <field name="action" nolabel="1" colspan="2" />
                                </group>
                            </group>
                            <group colspan="4" col="4" string="Routing Lines">
                                <field name="routing_line_ids" nolabel="1" colspan="4" readonly="0" />
                            </group>
                        </group>
                        <group colspan="1" col="1" class="op_shortcuts">
                            <separator colspan="1" string="Actions" name="separator_actions_menu" />
                            <button name="generate_nonconformity_manual" type="object" string="Create nonconformity file" class="oe_inline oe_stat_button" icon="fa-exclamation" />
                        </group>
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Complaints -->
        <record id='view_tree_mrp_rl_complaint' model='ir.ui.view'>
            <field name="name">view_tree_mrp_rl_complaint</field>
            <field name="model">mrp.rl.complaint</field>
            <field name="arch" type="xml">
                <tree string="Complaints" version="8.0">
                    <field name="name" />
                    <field name="date" />
                    <field name="customer_id" />
                    <field name="product_id" />
                    <field name="motif" />
                    <field name="cause" />
                    <field name="action" />
                    <field name="type" />
                </tree>
            </field>
        </record>

        <!-- SEARCH VIEW BoM option -->
        <record id='view_search_mrp_rl_complaint' model='ir.ui.view'>
            <field name="name">view_search_mrp_rl_complaint</field>
            <field name="model">mrp.rl.complaint</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <field name="name" />
                    <field name="date" />
                    <field name="customer_id" />
                    <field name="product_id" />
                    <field name="motif" />
                    <field name="cause" />
                    <field name="action" />
                    <field name="type" />
                </search>
            </field>
        </record>

        <!-- ACTION Bom option -->
        <record id="act_mrp_rl_complaint" model="ir.actions.act_window">
            <field name="name">Complaints</field>
            <field name="res_model">mrp.rl.complaint</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="view_search_mrp_rl_complaint" />
        </record>

        <menuitem name="Complaints" action="act_mrp_rl_complaint" id="menu_mrp_rl_complaint" parent="menu_routing_conf" sequence="30" groups="base_openprod.group_menu_tech_data_config" />


        <record id="act_mrp_rl_complaint_customer" model="ir.actions.act_window">
            <field name="name">Complaints</field>
            <field name="res_model">mrp.rl.complaint</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('type', '=', 'customer')]</field>
            <field name="context">{'default_type': 'customer'}</field>
            <field name="search_view_id" ref="view_search_mrp_rl_complaint" />
        </record>

        <menuitem name="Complaints" action="act_mrp_rl_complaint_customer" id="menu_mrp_rl_complaint_customer" parent="product.menu_quality_customer_id" sequence="40" groups="product.group_menu_customer_quality" />

        <record id="act_mrp_rl_complaint_intern" model="ir.actions.act_window">
            <field name="name">Complaints</field>
            <field name="res_model">mrp.rl.complaint</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('type', '=', 'intern')]</field>
            <field name="context">{'default_type': 'intern'}</field>
            <field name="search_view_id" ref="view_search_mrp_rl_complaint" />
        </record>

        <!-- ================== -->
        <!-- BoM option -->
        <!-- ================== -->

        <!-- FORM VIEW BoM option -->
        <record id='view_form_bom_option' model='ir.ui.view'>
            <field name="name">view_form_bom_option</field>
            <field name="model">mrp.option</field>
            <field name="arch" type="xml">
                <form string="BoM option" version="8.0">
                    <group colspan="4" col="4">
                        <group colspan="4" col="4" string="Details">
                            <field name="name" />
                            <label string="" colspan="2" />
                            <field name="group_id" />
                            <field name="price_unit" />
                        </group>
                        <group colspan="4" col="4" string="Description">
                            <field name="description" nolabel="1" colspan="4" />
                        </group>
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW BoM option -->
        <record id='view_tree_bom_option' model='ir.ui.view'>
            <field name="name">view_tree_bom_option</field>
            <field name="model">mrp.option</field>
            <field name="arch" type="xml">
                <tree string="BoM option" version="8.0">
                    <field name="name" />
                    <field name="group_id" />
                    <field name="price_unit" />
                </tree>
            </field>
        </record>

        <!-- SEARCH VIEW BoM option -->
        <record id='view_search_bom_option' model='ir.ui.view'>
            <field name="name">view_search_bom_option</field>
            <field name="model">mrp.option</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <field name="name" />
                    <field name="group_id" />
                    <group expand="0" string="Group By...">
                        <filter string="Group" domain="[]" context="{'group_by': 'group_id'}" />
                    </group>
                </search>
            </field>
        </record>

        <!-- ACTION Bom option -->
        <record id="act_mrp_bom_option" model="ir.actions.act_window">
            <field name="name">Option</field>
            <field name="res_model">mrp.option</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="view_search_bom_option" />
        </record>

        <menuitem name="Option" action="act_mrp_bom_option" id="menu_mrp_bom_option" parent="menu_bom_conf" sequence="20" groups="base_openprod.group_menu_tech_data_config" />

        <!-- ======================== -->
        <!-- ManufacturingOrder -->
        <!-- ======================== -->


        <!-- FORM VIEW Manufacturing -->
        <record id='view_form_mrp_manufacturingorder' model='ir.ui.view'>
            <field name="name">view_form_mrp_manufacturingorder</field>
            <field name="model">mrp.manufacturingorder</field>
            <field name="arch" type="xml">
                <form string="Manufacturing" version="8.0">
                    <header>
                        <button name="wkf_draft" states="waiting,cancel" string="Draft" type="object" class="oe_highlight" />
                        <button name="wkf_ready" states="plan" string="Ready" type="object" class="oe_highlight" />
                        <button name="wkf_progress" states="ready,pause" string="Progress" type="object" class="oe_highlight" />
                        <button name="wkf_pause" states="progress" string="Pause" type="object" class="oe_highlight" />
                        <button name="wkf_done" states="progress,pause" string="Done" type="object" class="oe_highlight" />
                        <button name="wkf_cancel" states="draft,waiting,plan,ready,progress,pause,done" string="Cancel" type="object" class="openprod_cancel_button" confirm="Are you sure you want to cancel this manufacturing order?" />
                        <field name="state" widget="statusbar" statusbar_visible="draft, waiting, ready, progress, done" />
                    </header>
                    <group colspan="4" col="9">
                        <group colspan="8" col="4">
                            <group colspan="4" col="6">
                                <group colspan="6" col="6">
                                    <field name="name" colspan="4" attrs="{'readonly':[('workorder_ids','!=', [])]}" />
                                    <field name="company_id" colspan="2" attrs="{'readonly':[('workorder_ids','!=', [])]}" />
                                </group>
                                <group colspan="2" string="Product" col="2">
                                    <field name="product_id" attrs="{'readonly':[('workorder_ids','!=', [])]}" domain="[('produce_ok', '=', True)]" />
                                    <field name="bom_id" attrs="{'readonly':['|', ('is_without_bom', '=', True), ('workorder_ids','!=', [])], 'required': [('is_without_bom', '=', False)]}" domain="product_id and prod_family_id and [('bom_id', '=', False),('state', '!=', 'obsolete'), '|', ('product_id', '=', product_id), ('prod_family_id', '=', prod_family_id)] or product_id and [('bom_id', '=', False),('state', '!=', 'obsolete'), ('product_id', '=', product_id)] or [('id', '=', False)]" />
                                    <field name="routing_id" domain="bom_id and [('bom_ids','=',bom_id), ('state', '=', 'active')] or [('id','=',False)]" attrs="{'readonly':[('workorder_ids','!=', [])]}" />
                                    <field name="uom_id" />
                                    <field name="prod_family_id" invisible="1" />
                                    <field name="is_without_bom" readonly="0" />
                                    <field name="is_use_kit" readonly="0" />
                                </group>
                                <group colspan="2" string="Request" col="3" attrs="{'readonly':[('state','!=','draft')]}">
                                    <field name="sale_line_id" colspan="3" />
                                    <field name="customer_id" colspan="3" />
                                    <field name="needed_quantity" attrs="{'readonly':[('workorder_ids','!=', [])]}" colspan="3" />
                                    <field name="quantity" attrs="{'readonly':[('workorder_ids','!=', [])]}" colspan="3" />
                                    <field name="is_forecast" attrs="{'readonly':[('workorder_ids','!=', [])]}" />
                                    <button name="button_validate_forecast" string="" type="object" attrs="{'invisible':[('is_forecast','!=', True)]}" icon="gtk-apply" confirm="Caution, you will convert the forecast MO in firm MO, are you sure you want to confirm this MO?" />
                                </group>
                                <group colspan="2" string="Dates" col="2" attrs="{'readonly':[('state','!=','draft')]}">
                                    <field name="requested_date" />
                                    <field name="min_start_date" />
                                    <field name="max_end_date" />
                                    <field name="planned_start_date" />
                                    <field name="planned_end_date" />
                                    <field name="need_delay_validation" invisible="1" />
                                    <button name="conf_delay_button" string="Confirm date" type="object" attrs="{'invisible': [('need_delay_validation', '!=', True)]}" />
                                </group>
                            </group>

                            <notebook colspan="4">
                                <page string="Workorder List">
                                    <group colspan="4" string="Workorder List">
                                        <field name="workorder_ids" coslpan="4" nolabel="1" context="{'from_object': True'}" />
                                    </group>
                                </page>
                                <page string="Comment">
                                    <group colspan="4" string="Comment">
                                        <label for="note_planned" string="Note for planned" />
                                        <field name="note_planned" nolabel="1" colspan="4" />
                                        <label for="note_manufacturing" string="Note for manufacturing" />
                                        <field name="note_manufacturing" nolabel="1" colspan="4" />
                                        <label for="note_origin" string="Origin" />
                                        <field name="note_origin" nolabel="1" colspan="4" />
                                    </group>
                                </page>
                                <page string="Options">
                                    <group colspan="4" string="Options" name="options_page" groups="mrp.mrp_options">
                                        <field name="option_ids" nolabel="1" attrs="{'readonly':[('workorder_ids', '!=', [])]}">
                                            <tree string="Options" version="8.0">
                                                <field name="name" />
                                                <field name="group_id" />
                                            </tree>
                                        </field>
                                    </group>
                                </page>
                                <page string="Parameters" groups="product.product_parameters">
                                    <group colspan="4" string="Parameters">
                                        <field name="parameter_ids" nolabel="1" attrs="{'readonly':[('workorder_ids', '!=', [])]}">
                                            <tree editable="bottom" string="Parameters">
                                                <field name="type_param_id" />
                                                <field name="value" />
                                                <field name="name" invisible="1" />
                                            </tree>
                                        </field>
                                    </group>
                                </page>
                                <page string="Internal documents">
                                    <group colspan="4" string="Internal documents">
                                        <field name="internal_plan_ids" nolabel="1" />
                                    </group>
                                </page>
                                <page string="Cost" name="page_cost_manuf" >
                                    <group colspan="4" col="4" name="cost_mo_group">
                                        <group colspan="2" col="2" string="Theoretical">
                                            <field name="theo_rm_cost" />
                                            <field name="theo_produce_cost" />
                                            <field name="theo_subcontracting_cost" />
                                            <field name="theo_total_cost" />
                                            <button name="button_clear_theo_costs" type="object" string="Clear" class="oe_inline oe_stat_button" icon="fa-eraser" colspan="4" />
                                            <button name="button_compute_theo_costs" type="object" string="Compute" class="oe_inline oe_stat_button" icon="fa-cogs" colspan="4" />
                                        </group>
                                        <group colspan="2" col="2" string="Real">
                                            <field name="real_rm_cost" />
                                            <field name="real_produce_cost" />
                                            <field name="real_subcontracting_cost" />
                                            <field name="real_total_cost" />
                                            <field name="produce_total_qty" />
                                            <button name="button_clear_real_costs" type="object" string="Clear" class="oe_inline oe_stat_button" icon="fa-eraser" colspan="4" />
                                            <button name="button_compute_real_costs" type="object" string="Compute" class="oe_inline oe_stat_button" icon="fa-cogs" colspan="4" />
                                        </group>
                                    </group>
                                </page>
                            </notebook>
                        </group>
                        <group colspan="1" col="1" class="op_shortcuts">
                            <separator colspan="1" string="Actions" name="separator_actions_menu" />
                            <button type="object" string="WOs" name="action_generating_wo" class="oe_inline oe_stat_button" icon="fa-check" attrs="{'invisible': ['|', ('workorder_ids', '!=', []), ('is_without_bom', '=', True)]}" />
                            <button type="action" string="Plan MO at earlier" name="%(act_mrp_planning_mo_at_earlier_id)d" class="oe_inline oe_stat_button" icon="fa-calendar" attrs="{'invisible':['|', ('workorder_ids', '=', []), ('state', 'in', ('cancel', 'done'))]}" />
                            <button type="action" string="Plan MO at the latest" name="%(act_mrp_planning_mo_at_the_latest_id)d" class="oe_inline oe_stat_button" icon="fa-calendar" attrs="{'invisible':['|', ('workorder_ids', '=', []), ('state', 'in', ('cancel', 'done'))]}" />
                            <button type="action" string="Plan MO Done" name="%(act_mrp_planning_mo_done_id)d" class="oe_inline oe_stat_button" icon="fa-calendar" attrs="{'invisible':['|', ('workorder_ids', '=', []), ('state', 'in', ('cancel', 'done'))]}" />
                            <button name="%(action_print_mo)d" string="Print the works orders" type="action" class="oe_inline oe_stat_button" icon="fa-print" />
                            <separator colspan="1" string="Modifications" name="separator_modif_menu" />
                            <button name="button_split" string="Split" type="object" class="oe_inline oe_stat_button" icon="fa-columns" attrs="{'invisible':[('state', 'in', ('cancel', 'done'))]}" />
                            <button name="%(act_wo_change_mo_qty)d" string="Change Qty" type="action" class="oe_inline oe_stat_button" icon="fa-pencil-square-o" context="{'mo_change_qty': True}" attrs="{'invisible':[('state', 'in', ('progress', 'pause', 'cancel', 'done'))]}" />
                            <button name="button_del_mo_and_son_mo" string="Delete MO and son MO" type="object" class="oe_inline oe_stat_button" icon="fa-times" confirm="Warning, you will remove MO and children" />
                            <separator colspan="1" string="Analysis" name="separator_analysis_menu" />
                            <button name="%(sale_purchase.action_display_reservation)d" string="Display reservations" type="action" context="{'reservation_product_id': product_id}" icon="fa-list-ul" class="oe_inline oe_stat_button" />
                            <button class="oe_inline oe_stat_button" string="Open procurement" type="object" name="open_source_procurement" icon="fa-sign-in" />
                            <button name="%(action_son_mo_wiz)d" string="Son MO view" type="action" class="oe_inline oe_stat_button" icon="fa-list-ul" />
                            <button name="%(action_son_wo_wiz)d" string="Son WO view" type="action" class="oe_inline oe_stat_button" icon="fa-list-ul" />
                        </group>
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Manufacturing -->
        <record id='view_tree_mrp_manufacturingorder' model='ir.ui.view'>
            <field name="name">view_tree_mrp_manufacturingorder</field>
            <field name="model">mrp.manufacturingorder</field>
            <field name="arch" type="xml">
                <tree string="Manufacturings" version="8.0" colors="gray:state=='cancel'; blue:state=='draft'; brown:state=='done';">
                    <field name="color_priority_need_move" colors="red:color_priority_need_move==3; orange:color_priority_need_move==2; green:color_priority_need_move==1; black:color_priority_need_move==4;" string=" " invisible="0" />
                    <field name="name" />
                    <field name="product_id" />
                    <field name="quantity" />
                    <field name="uom_id" />
                    <field name="bom_id" />
                    <field name="routing_id" />
                    <field name="procurement_deleted" />
                    <field name="state" />
                    <field name="waiting_delay" invisible="1" />
                    <field name="need_delay_validation" invisible="1" />
                    <button name="conf_delay_button" string="Confirm date" type="object" attrs="{'invisible': [('need_delay_validation', '!=', True)]}" />
                    <field name="customer_id" invisible="1" />
                    <field name="week_number" invisible="1" />
                    <field name="month" invisible="1" />
                    <field name="is_week" invisible="1" />
                    <field name="is_next_week" invisible="1" />
                    <field name="is_month" invisible="1" />
                </tree>
            </field>
        </record>

        <!-- SEARCH VIEW Manufacturing -->
        <record id='view_search_mrp_manufacturingorder' model='ir.ui.view'>
            <field name="name">view_search_mrp_manufacturingorder</field>
            <field name="model">mrp.manufacturingorder</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <field name="year" noformat="1" />
                    <field name="month" />
                    <field name="week_number" />
                    <field name="customer_id" />
                    <field name="product_id" />
                    <field name="state" />
                    <group string="Filters">
                        <filter name="green" string="Green" domain="[('color_priority_need_move', '=', 1)]" />
                        <filter name="orange" string="Orange" domain="[('color_priority_need_move', '=', 2)]" />
                        <filter name="red" string="Red" domain="[('color_priority_need_move', '=', 3)]" />
                        <filter name="black" string="Black" domain="[('color_priority_need_move', '=', 4)]" />
                        <filter name="not_cancelled" string="Not cancelled or done" domain="[('state', 'not in', ('done','cancel'))]" />
                        <separator orientation="vertical" />
                        <filter string="Procurement deleted" domain="[('procurement_deleted', '=', True)]" />
                        <separator orientation="vertical" />
                        <filter string="To confirm" domain="[('need_delay_validation', '=', True)]" />
                        <separator orientation="vertical" />
                        <filter string="Week" domain="[('is_week', '=', True)]" />
                        <filter string="Following week" domain="[('is_next_week', '=', True)]" />
                        <filter string="Current month" domain="[('is_month', '=', True)]" />
                    </group>
                    <newline />
                    <group expand="0" string="Group By...">
                        <filter string="Year" icon="terp-partner" context="{'group_by' : 'year'}" />
                        <filter string="Month" icon="terp-partner" context="{'group_by' : 'month'}" />
                        <filter string="Week" icon="terp-partner" context="{'group_by' : 'week_number'}" />
                        <separator orientation="vertical" />
                        <filter string="Customer" icon="terp-partner" context="{'group_by' : 'customer_id'}" />
                        <separator orientation="vertical" />
                        <filter string="Product" icon="terp-partner" context="{'group_by' : 'product_id'}" />
                        <separator orientation="vertical" />
                        <filter string="State" icon="terp-partner" context="{'group_by' : 'state'}" />
                    </group>
                </search>
            </field>
        </record>

        <!-- ACTION Manufacturing -->
        <record id="act_mrp_manufacturingorder" model="ir.actions.act_window">
            <field name="name">Manufacturing</field>
            <field name="res_model">mrp.manufacturingorder</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{'search_default_not_cancelled': 1}</field>
            <field name="search_view_id" ref="view_search_mrp_manufacturingorder" />
        </record>

        <record id="act_mrp_manufacturingorder_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_manufacturingorder" />
            <field name="act_window_id" ref="act_mrp_manufacturingorder" />
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_manufacturingorder_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_manufacturingorder" />
            <field name="act_window_id" ref="act_mrp_manufacturingorder" />
        </record>

        <!-- ACTION Manufacturing order tree -->
        <record model="ir.actions.act_window" id="action_see_all_mo">
            <field name="name">Manufacturing</field>
            <field name="res_model">mrp.manufacturingorder</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="view_tree_mrp_manufacturingorder" />
            <field name="view_mode">tree,form</field>
            <field name="target">current</field>
        </record>

        <menuitem name="Manufacturing Order" action="act_mrp_manufacturingorder" id="menu_mrp_manufacturingorder" parent="menu_production_manufacturing" groups="group_menu_manuf_user" />


        <!-- =============== -->
        <!-- WORKORDER -->
        <!-- =============== -->

        <!-- FORM VIEW Workorder -->
        <record id='view_form_mrp_workorder' model='ir.ui.view'>
            <field name="name">view_form_mrp_workorder</field>
            <field name="model">mrp.workorder</field>
            <field name="arch" type="xml">
                <form string="Workorder" version="8.0">
                    <header>
                        <button name="wkf_draft" states="waiting,cancel" string="Draft" type="object" class="oe_highlight" />
                        <button name="wkf_ready" states="plan" string="Ready" type="object" class="oe_highlight" />
                        <button name="wkf_progress" states="ready,pause" string="Progress" type="object" class="oe_highlight" />
                        <button name="wkf_pause" states="progress" string="Pause" type="object" class="oe_highlight" />
                        <button name="wkf_done" states="ready,progress,pause" string="Done" type="object" class="oe_highlight" />
                        <button name="button_reopen" states="done" string="Reopen" type="object" class="oe_highlight" />
                        <button name="wkf_cancel" states="draft,waiting,plan,ready,progress,pause,done" string="Cancel" type="object" class="openprod_cancel_button" confirm="Are you sure you want to cancel this work order?" />
                        <field name="state" widget="statusbar" statusbar_visible="draft, waiting, ready, progress, done" />
                    </header>
                    <group colspan="4" col="9">
                        <group colspan="8" col="4">
                            <group colspan="4" col="6">
                                <group colspan="2" col="2">
                                    <field name="sequence" required="1" />
                                    <field name="sale_line_id" />
                                    <field name="final_product_id" />
                                    <field name="availability" widget="progressbar" />
                                </group>
                                <group colspan="2" col="2">
                                    <field name="name" />
                                    <field name="customer_id" />
                                    <field name="quantity" readonly="1" />
                                    <field name="advancement" />
                                </group>
                                <group colspan="2" col="2">
                                    <field name="mo_id" invisible="context.get('from_object', False)" readonly="1" />
                                    <field name="requested_date" />
                                    <field name="uom_id" />
                                    <field name="company_id" colspan="2" />
                                </group>
                            </group>
                            <field name="color_priority_need_move" invisible="1" />
                            <notebook colspan="4">
                                <page string="Component">
                                    <group colspan="4" col="4">
                                        <group colspan="2" col="2" string="Waiting">
                                            <button type="action" string="Add RM" name="%(act_create_rm_id)d" class="oe_inline oe_stat_button" icon="fa-plus" />
                                            <field name="rm_draft_ids" nolabel="1" colspan="2">
                                                <tree string="Stock moves" version="8.0" colors="gray:state=='cancel'; blue:state=='draft'; brown:state=='done';">
                                                    <field name="color_priority_need" colors="red:color_priority_need==3; orange:color_priority_need==2; green:color_priority_need==1; black:color_priority_need==4" string=" " invisible="0" />
                                                    <field name="product_id" />
                                                    <button name="%(sale_purchase.action_display_reservation)d" string="Display reservations" type="action" icon="terp-tools" />
                                                    <button name="%(stock.act_add_move_label_wizard)d" string="Add move labels" type="action" icon="gtk-ok" attrs="{'invisible': ['|', ('state', '=', 'done'), ('track_label_product', '!=', True)]}" />
                                                    <field name="uom_qty" />
                                                    <field name="uom_id" />
                                                    <field name="covered_by_stock_percent" widget="progressbar" />
                                                    <field name="is_confirmed" />
                                                    <field name="available_date" />
                                                    <field name="location_id" />
                                                    <field name="location_dest_id" />
                                                    <field name="state" />
                                                    <button name="prioritizing" string="Prioritizing" type="object" icon="terp-emblem-important" />
                                                    <field name="track_label_product" invisible="1" />
                                                </tree>
                                            </field>
                                            <button type="action" string="Add FP" name="%(act_create_fp_id)d" class="oe_inline oe_stat_button" icon="fa-plus" />
                                            <field name="fp_draft_ids" nolabel="1" colspan="2">
                                                <tree string="Stock moves" version="8.0" colors="gray:state=='cancel'; blue:state=='draft'; brown:state=='done';">
                                                    <field name="color_priority_need" colors="red:color_priority_need==3; orange:color_priority_need==2; green:color_priority_need==1; black:color_priority_need==4" string=" " invisible="0" />
                                                    <field name="product_id" />
                                                    <button name="%(stock.act_add_move_label_wizard)d" string="Add move labels" type="action" icon="gtk-ok" context="{'default_is_declared_pf': True }" attrs="{'invisible': ['|', ('state', '=', 'done'), ('track_label_product', '!=', True)]}" />
                                                    <field name="uom_qty" />
                                                    <field name="uom_id" />
                                                    <field name="location_id" />
                                                    <field name="location_dest_id" />
                                                    <field name="state" />
                                                    <field name="track_label_product" invisible="1" />
                                                </tree>
                                            </field>
                                        </group>
                                        <group colspan="2" col="2" string="Finished">
                                            <field name="rm_done_ids" nolabel="1" colspan="2">
                                                <tree string="Stock moves" version="8.0" colors="gray:state=='cancel'; blue:state=='draft'; brown:state=='done';">
                                                    <field name="color_priority_need" colors="red:color_priority_need==3; orange:color_priority_need==2; green:color_priority_need==1; black:color_priority_need==4" string=" " invisible="1" />
                                                    <field name="product_id" />
                                                    <field name="uom_qty" />
                                                    <field name="uom_id" />
                                                    <field name="location_id" />
                                                    <field name="location_dest_id" />
                                                    <field name="state" />
                                                </tree>
                                            </field>
                                            <field name="fp_done_ids" nolabel="1" colspan="2">
                                                <tree string="Stock moves" version="8.0" colors="gray:state=='cancel'; blue:state=='draft'; brown:state=='done';">
                                                    <field name="color_priority_need" colors="red:color_priority_need==3; orange:color_priority_need==2; green:color_priority_need==1; black:color_priority_need==4" string=" " invisible="1" />
                                                    <field name="product_id" />
                                                    <field name="uom_qty" />
                                                    <field name="uom_id" />
                                                    <field name="location_id" />
                                                    <field name="location_dest_id" />
                                                    <field name="state" />
                                                </tree>
                                            </field>
                                        </group>
                                    </group>
                                </page>
                                <page string="Resource">
                                    <group colspan="4" col="4" string="Resource">
                                        <group colspan="4" col="6">
                                            <group colspan="2" col="2">
                                                <field name="first_resource_id" />
                                                <field name="categ_first_resource_id" />
                                                <field name="correct_time" />
                                            </group>
                                            <group colspan="2" col="2">
                                                <field name="total_time_real" widget="float_time_seconds" />
                                                <field name="total_time_theo" widget="float_time_seconds" />
                                                <field name="corrected_time" />
                                            </group>
                                            <group colspan="2" col="2">
                                                <field name="difference" />
                                                <field name="is_subcontracting" />
                                                <field name="is_supplier_delay_subc" attrs="{'invisible': [('is_subcontracting', '!=', True)]}" />
                                                <field name="modif_time_int" invisible="1" />
                                            </group>
                                        </group>
                                        <field name="wo_resource_ids" nolabel="1" colspan="4">
                                            <tree string="Workorder Resource">
                                                <field name="sequence" />
                                                <field name="resource_id" />
                                                <field name="nb_product_parallel" />
                                                <field name="preparation_time" widget="float_time_seconds" />
                                                <field name="production_time" widget="float_time_seconds" />
                                                <field name="cleaning_time" widget="float_time_seconds" />
                                                <field name="total_time_theo" widget="float_time_seconds" />
                                                <field name="total_time_theo_with_masked" widget="float_time_seconds" />
                                                <field name="total_time_real" widget="float_time_seconds" />
                                                <field name="difference" />
                                                <button type="action" string="Change resource" name="%(act_mrp_change_resource_wo_id)d" class="oe_inline oe_stat_button" />
                                                <button type="action" string="Add resource" name="%(act_mrp_add_resource_wo_id)d" class="oe_inline oe_stat_button" />
                                            </tree>
                                        </field>
                                        <group colspan="4" col="7" attrs="{'invisible':[('state', 'not in', ('ready', 'progress', 'pause'))]}">
                                            <button name="button_waiting_timetracking" string="Waiting" type="object" class="oe_inline oe_stat_button" icon="fa-check" />
                                            <button name="button_setting_timetracking" string="Setting" type="object" class="oe_inline oe_stat_button" icon="fa-check" />
                                            <button name="button_production_timetracking" string="Production" type="object" class="oe_inline oe_stat_button" icon="fa-check" />
                                            <button name="button_cleaning_timetracking" string="Cleaning" type="object" class="oe_inline oe_stat_button" icon="fa-check" />
                                            <button name="button_stop_timetracking" string="Stop" type="object" class="oe_inline oe_stat_button" icon="fa-check" />
                                            <field name="state_timetracking" colspan="2" />
                                        </group>
                                    </group>
                                </page>
                                <page string="Procurement">
                                    <group colspan="4" col="4" string="RM Procurement">
                                        <field name="procurement_ids" nolabel="1" colspan="4" readonly="1">
                                            <tree string="Procurements">
                                                <field name="pol_id" />
                                                <button type="object" string="Create PO" name="create_po" attrs="{'invisible': ['|', '|', ('supply_method', '!=', 'buy'), ('pol_id', '!=', False), ('state', 'in', ('done','cancel'))]}" />
                                                <button type="object" string="Delete PO" name="unlink_po" attrs="{'invisible': ['|', '|', ('supply_method', '!=', 'buy'), ('pol_id', '=', False), ('state', 'in', ('done','cancel'))]}" />
                                                <field name="mo_id" />
                                                <button type="object" string="Create MO" name="create_mo" attrs="{'invisible': ['|', '|', ('supply_method', '!=', 'produce'), ('mo_id', '!=', False), ('state', 'in', ('done','cancel'))]}" />
                                                <button type="object" string="Delete MO" name="unlink_mo" attrs="{'invisible': ['|', '|', ('supply_method', '!=', 'produce'), ('mo_id', '=', False), ('state', 'in', ('done','cancel'))]}" />
                                                <field name="product_id" />
                                                <!-- <field name="needed_uom_qty" /> -->
                                                <!-- <field name="needed_uom_id" /> -->
                                                <field name="needed_date" />
                                                <field name="state" />
                                                <field name="supply_method" invisible="1" />
                                            </tree>
                                        </field>
                                        <button name="validate_procurement_rm" string="Validate Procurement RM" type="object" class="oe_inline oe_stat_button" icon="fa-check" />
                                    </group>
                                    <group colspan="4" col="4" string="Consumed Service" name="group_consumed_service">
                                        <field name="consumed_service_ids" nolabel="1" colspan="4" attrs="{'readonly':[('wo_subc_pol_fp_ids', '!=', [])]}">
                                            <tree string="Services" editable="bottom">
                                                <field name="product_id" domain="[('type','=','service'), ('manage_service_receipt', '=', True)]" />
                                                <field name="quantity" />
                                                <field name="uom_id" domain="[('category_id','=',uom_category_id)]" />
                                                <field name="uom_category_id" invisible="1" />
                                                <field name="type" />
                                                <field name="price_total" />
                                                <field name="is_fp" />
                                            </tree>
                                        </field>
                                    </group>
                                </page>
                                <page string="Planning">
                                    <group colspan="4" col="4">
                                        <group colspan="2" col="2" string="Date and Planning">
                                            <group colspan="2" col="4">
                                                <field name="availability_date_rm" colspan="4" />
                                                <field name="availability_delay_rm" colspan="4" />
                                                <field name="availability_simulation" colspan="3" />
                                                <button name="button_availability_simulation_compute" string="Compute" type="object" />
                                                <field name="is_at_earlier" />
                                            </group>
                                            <group colspan="1" col="2" string="Start Date">
                                                <field name="min_date" />
                                                <field name="planned_start_date" readonly="1" />
                                                <field name="real_start_date" />
                                            </group>
                                            <group colspan="1" col="2" string="End Date">
                                                <field name="max_date" />
                                                <field name="planned_end_date" readonly="1" />
                                                <field name="real_end_date" />
                                            </group>
                                            <field name="waiting_time_next_ope" />
                                            <field name="percentage_overlap_next_ope" />
                                        </group>
                                        <group colspan="2" col="2" string="Various" name="group_various_plan">
                                            <field name="is_forecast" readonly="1" />
                                            <field name="routing_line_id" readonly="1" />
                                            <field name="index" />
                                            <field name="group_wo_id" />
                                        </group>
                                    </group>
                                </page>
                                <page string="Declaration">
                                    <group colspan="4" col="6">
                                        <group colspan="2" col="2" string="Parameter">
                                            <field name="close_wo_prev" />
                                            <field name="availability_force" />
                                            <field name="compute_availability_material" />
                                            <field name="allow_operator_add" />
                                            <field name="declare_tablet_product" attrs="{'invisible': [('group_wo_id', '!=', False)]}" />
                                            <field name="produce_more" />
                                        </group>
                                        <group colspan="4" col="4" string="Consumption Declaration">
                                            <field name="workorder_consumption_ids" colspan="4" nolabel="1" readonly="1" />
                                        </group>
                                        <group colspan="2" col="2">
                                            <group colspan="2" col="2" string="Labels Consumed" name="group_labels_consumed">
                                                <field name="label_consumed_ids" nolabel="1" context="{'default_wo_id':active_id}">
                                                    <tree editable="bottom">
                                                        <field name="label_id" domain="[('label_wo_search', '=', wo_id)]" />
                                                        <field name="product_id" readonly="1" />
                                                        <field name="quantity" />
                                                        <field name="uom_id" readonly="1" />
                                                        <field name="use_consumption" />
                                                        <field name="quantity_label" invisible="1" />
                                                        <field name="wo_id" invisible="1" />
                                                    </tree>
                                                </field>
                                            </group>
                                            <group colspan="2" col="2" string="Labels for production">
                                                <field name="label_production_ids" nolabel="1" context="{'default_wo_id': active_id}">
                                                    <tree editable="bottom">
                                                        <field name="label_id" domain="[('label_wo_production_search', '=', wo_id)]" />
                                                        <field name="product_id" readonly="1" />
                                                        <field name="quantity_label" readonly="1" />
                                                        <field name="uom_id" readonly="1" />
                                                        <field name="wo_id" invisible="1" />
                                                    </tree>
                                                </field>
                                            </group>
                                            <group colspan="2" col="2" string="Additional Resources">
                                                <field name="additional_resource_ids" nolabel="1" attrs="{'invisible':[('allow_operator_add', '=', False)]}">
                                                    <tree editable="bottom">
                                                        <field name="resource_id" domain="[('type', '=', 'human')]" />
                                                        <field name="start_date" />
                                                        <field name="end_date" />
                                                    </tree>
                                                </field>
                                            </group>
                                        </group>
                                        <group colspan="4" col="2">
                                            <group colspan="4" col="4" string="Production Declaration">
                                                <field name="workorder_produce_ids" colspan="4" nolabel="1" readonly="1" />
                                                <label for="note_tracability" string="Note tracability" />
                                                <field name="note_tracability" colspan="4" nolabel="1" />
                                            </group>
                                        </group>
                                    </group>
                                </page>
                                <page string="Tools and Quality">
                                    <group colspan="4" col="4" string="Tools" name="mrp_tools_group">
                                        <field name="tool_ids" colspan="4" nolabel="1">
                                            <tree string="Tools" editable="bottom">
                                                <field name="product_id" domain="[('type','=','tech_tool')]" context="{'default_type': 'tech_tool'}" />
                                                <field name="stock_label_id" />
                                                <field name="quantity" />
                                                <field name="uom_id" domain="[('category_id','=',uom_category_id)]" />
                                                <field name="uom_category_id" invisible="1" />
                                            </tree>
                                        </field>
                                    </group>
                                    <group colspan="4" col="4" string="Questionnaire">
                                        <field name="consign_ids" colspan="4" nolabel="1">
                                            <tree string="Consigns" editable="bottom">
                                                <field name="name" />
                                                <field name="frequency" />
                                                <field name="type" />
                                                <field name="desciptive" />
                                                <field name="means" />
                                            </tree>
                                        </field>
                                    </group>
                                    <group colspan="4" col="4" string="Routing line documents">
                                        <field name="rl_document_ids" colspan="4" nolabel="1" />
                                    </group>
                                </page>
                                <page string="Cost">
                                    <group colspan="4" col="4">
                                        <group colspan="2" col="2" string="Theoretical">
                                            <field name="theo_rm_cost" />
                                            <field name="theo_produce_cost" />
                                            <field name="theo_subcontracting_cost" />
                                            <field name="theo_total_cost" />
                                            <button name="button_clear_theo_costs" type="object" string="Clear" class="oe_inline oe_stat_button" icon="fa-eraser" colspan="4" />
                                            <button name="button_compute_theo_costs" type="object" string="Compute" class="oe_inline oe_stat_button" icon="fa-cogs" colspan="4" />
                                        </group>
                                        <group colspan="2" col="2" string="Real">
                                            <field name="real_rm_cost" />
                                            <field name="real_produce_cost" />
                                            <field name="real_subcontracting_cost" />
                                            <field name="real_total_cost" />
                                            <button name="button_clear_real_costs" type="object" string="Clear" class="oe_inline oe_stat_button" icon="fa-eraser" colspan="4" />
                                            <button name="button_compute_real_costs" type="object" string="Compute" class="oe_inline oe_stat_button" icon="fa-cogs" colspan="4" />
                                        </group>
                                    </group>
                                </page>
                                <page string="Notes and Various">
                                    <group colspan="4" col="4">
                                        <group colspan="2" col="2">
                                            <group colspan="2" col="2" string="Previous Workorder">
                                                <field name="prev_wo_ids" nolabel="1" colspan="2" />
                                            </group>
                                            <group colspan="2" col="2" string="Next Workorder">
                                                <field name="next_wo_ids" nolabel="1" colspan="2" />
                                            </group>
                                        </group>
                                        <group colspan="2" col="2" string="Note">
                                            <label for="note_planned" string="Note for planning" />
                                            <field name="note_planned" colspan="4" nolabel="1" />
                                            <label for="note_manufacturing" string="Note for manufacturing" />
                                            <field name="note_manufacturing" colspan="4" nolabel="1" />
                                        </group>
                                    </group>
                                </page>
                                <page string="Subcontracting" attrs="{'invisible':[('is_subcontracting', '!=', True)]}">
                                    <group colspan="4" col="4" string="POL RM">
                                        <field name="wo_subc_pol_rm_ids" nolabel="1" colspan="4" readonly="1" domain="[('purchase_state', '!=', 'cancel')]">
                                            <tree string="POL RM">
                                                <field name="product_id" />
                                                <field name="uom_qty" />
                                                <field name="uom_id" />
                                                <field name="type_subcontracting" />
                                                <field name="purchase_partner_id" />
                                                <field name="expected_date" />
                                                <field name="purchase_order_id" />
                                                <field name="purchase_state" />
                                                <button name="button_open_achat" string="Purchase" type="object" icon="terp-tools" />
                                            </tree>
                                        </field>
                                    </group>
                                    <group colspan="2" col="2" string="Move RM">
                                        <field name="wo_subc_move_rm_ids" colspan="4" nolabel="1" readonly="1">
                                            <tree string="Move RM">
                                                <field name="product_id" />
                                                <field name="uom_qty" />
                                                <field name="uom_id" />
                                                <field name="type_subcontracting" />
                                                <field name="date_expected" />
                                                <field name="purchase_line_id" />
                                                <field name="picking_id" />
                                                <field name="state" />
                                                <button name="button_open_picking" string="Picking" type="object" icon="terp-tools" />
                                            </tree>
                                        </field>
                                    </group>
                                    <group colspan="2" col="2" string="POL FP">
                                        <field name="wo_subc_pol_fp_ids" colspan="4" nolabel="1" readonly="1" domain="[('purchase_state', '!=', 'cancel')]">
                                            <tree string="POL FP">
                                                <field name="product_id" />
                                                <field name="uom_qty" />
                                                <field name="uom_id" />
                                                <field name="type_subcontracting" />
                                                <field name="purchase_partner_id" />
                                                <field name="expected_date" />
                                                <field name="purchase_order_id" />
                                                <field name="purchase_state" />
                                                <button name="button_open_achat" string="Purchase" type="object" icon="terp-tools" />
                                            </tree>
                                        </field>
                                    </group>
                                    <group colspan="2" col="2" string="Move Fp">
                                        <field name="wo_subc_move_fp_ids" colspan="4" nolabel="1" readonly="1">
                                            <tree string="Move FP">
                                                <field name="product_id" />
                                                <field name="uom_qty" />
                                                <field name="uom_id" />
                                                <field name="type_subcontracting" />
                                                <field name="date_expected" />
                                                <field name="purchase_line_id" />
                                                <field name="picking_id" />
                                                <field name="state" />
                                                <button name="button_open_picking" string="Picking" type="object" icon="terp-tools" />
                                            </tree>
                                        </field>
                                    </group>
                                    <group colspan="2" col="2" string="Counterpart move" groups="base.group_erp_manager">
                                        <field name="subc_move_counterpart_ids" colspan="4" nolabel="1" readonly="1">
                                            <tree string="Move FP">
                                                <field name="product_id" />
                                                <field name="uom_qty" />
                                                <field name="uom_id" />
                                                <field name="state" />
                                            </tree>
                                        </field>
                                        <button name="compute_subcontracting_counterpart_move" string="Compute" type="object" class="oe_inline oe_stat_button" icon="fa-cogs" />
                                    </group>
                                    <group colspan="4" col="4" string="Warning">
                                        <field name="is_warning_subc" colspan="2" />
                                        <field name="is_subc_no_regul" colspan="2" />
                                        <field name="warning_subc" colspan="4" nolabel="1" />
                                    </group>
                                </page>
                            </notebook>
                        </group>
                        <group colspan="1" col="1" class="op_shortcuts">
                            <separator colspan="1" string="Actions" name="separator_actions_menu" />
                            <button name="%(action_wo_declaration_main)d" string="Declaration" type="action" class="oe_inline oe_stat_button" icon="fa-check" attrs="{'invisible':['|', ('is_subcontracting', '=', True), ('state', 'in', ('draft', 'waiting', 'cancel', 'done'))]}" />
                            <button name="%(action_purchase_subcontracting_rm)d" string="RM" type="action" context="{'default_wo_id':active_id}" icon="fa-check" class="oe_inline oe_stat_button" attrs="{'invisible':['|', ('is_subcontracting', '!=', True),('state', 'in', ('draft', 'waiting', 'cancel', 'done'))]}" />
                            <button name="%(action_purchase_subcontracting_fp)d" string="FP" type="action" context="{'default_wo_id':active_id}" icon="fa-check" class="oe_inline oe_stat_button" attrs="{'invisible':['|', ('is_subcontracting', '!=', True),('state', 'in', ('draft', 'waiting', 'cancel', 'done'))]}" />
                            <button name="button_regul_rmst" string="Regul RM Subc" type="object" class="oe_inline oe_stat_button" icon="fa-list-ul" attrs="{'invisible':['|', ('is_subcontracting', '!=', True),('state', '!=', 'done')]}" />
                            <button name="%(action_more_produce)d" string="More produce" type="action" class="oe_inline oe_stat_button" icon="fa-check" attrs="{'invisible':['|', ('state', 'in', ('draft', 'waiting', 'plan', 'ready', 'cancel', 'done')), ('produce_more', '!=', True)]}" />
                            <button type="action" string="Plan WO Done" name="%(act_mrp_planning_wo_done_id)d" class="oe_inline oe_stat_button" icon="fa-calendar" attrs="{'invisible':[('state', 'in', ('draft', 'cancel', 'done'))]}" />
                            <button name="%(action_print_wo)d" string="Print the work order" type="action" class="oe_inline oe_stat_button" icon="fa-print" />
                            <separator colspan="1" string="Modifications" name="separator_modif_menu" />
                            <button name="button_split" string="Split" type="object" class="oe_inline oe_stat_button" icon="fa-columns" attrs="{'invisible':[('state', 'in', ('cancel', 'done'))]}" />
                            <button name="%(act_wo_change_mo_qty)d" string="Change Qty" type="action" class="oe_inline oe_stat_button" icon="fa-pencil-square-o" attrs="{'invisible':[('state', 'in', ('progress', 'pause', 'cancel', 'done'))]}" />
                            <button name="%(act_change_date_wo)d" string="Change Date" type="action" class="oe_inline oe_stat_button" icon="fa-calendar" attrs="{'invisible':[('state', 'in', ('cancel', 'done'))]}" />
                            <button name="%(act_mrp_add_operation_id)d" string="Add Operation" type="action" class="oe_inline oe_stat_button" icon="fa-check" attrs="{'invisible':[('state', 'in', ('cancel', 'done'))]}" />
                            <separator colspan="1" string="Analysis" name="separator_analysis_menu" />
                            <button name="%(sale_purchase.action_display_reservation)d" string="Display reservations" type="action" context="{'reservation_product_id': final_product_id}" icon="fa-list-ul" class="oe_inline oe_stat_button" />

                        </group>
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Workorder -->
        <record id='view_tree_mrp_workorder' model='ir.ui.view'>
            <field name="name">view_tree_mrp_workorder</field>
            <field name="model">mrp.workorder</field>
            <field name="arch" type="xml">
                <tree string="Workorders" version="8.0" colors="gray:state=='cancel'; blue:state=='draft'; brown:state=='done';">
                    <field name="color_priority_need_move" colors="red:color_priority_need_move==3; orange:color_priority_need_move==2; green:color_priority_need_move==1; black:color_priority_need_move==4" string=" " invisible="0" />
                    <field name="final_product_id" />
                    <field name="mo_id" />
                    <field name="sequence" />
                    <field name="name" />
                    <field name="quantity" />
                    <field name="uom_id" />
                    <field name="planned_start_date" />
                    <!-- <field name="planned_end_date" /> -->
                    <field name="real_start_date" />
                    <field name="availability" widget="progressbar" />
                    <field name="first_resource_id" />
                    <button type="action" string="Change resource" name="%(act_mrp_change_resource_wo_id)d" icon="fa-pencil" />
                    <field name="total_time_theo" widget="float_time_seconds" sum="Theo Total Time Sum" />
                    <!-- <field name="total_time_real" widget="float_time_seconds" sum="Real Total Time Sum"/> -->
                    <field name="group_wo_id" />
                    <field name="state" />
                    <field name="advancement" />
                    <button type="action" string="Plan WO Done" name="%(act_mrp_planning_wo_done_id)d" icon="terp-tools" attrs="{'invisible':[('state', 'not in', ('draft', 'waiting'))]}" />
                    <field name="month" invisible="1" />
                    <field name="week_number" invisible="1" />
                    <field name="is_week" invisible="1" />
                    <field name="is_next_week" invisible="1" />
                    <field name="is_month" invisible="1" />
                </tree>
            </field>
        </record>

        <!-- SEARCH VIEW Workorder -->
        <record id='view_search_mrp_workorder' model='ir.ui.view'>
            <field name="name">view_search_mrp_workorder</field>
            <field name="model">mrp.workorder</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <field name="mo_id" />
                    <field name="customer_id" />
                    <field name="final_product_id" />
                    <field name="first_resource_id" />
                    <field name="year" noformat="1" />
                    <field name="month" />
                    <field name="week_number" />
                    <field name="state" />
                    <group string="Filters">
                        <filter name="dispo_100" string="availability" icon="terp-personal" domain="[('availability', 'in', 100)]" />
                        <filter name="dispo_less_100" string="availability Partial" icon="terp-personal" domain="[('availability', 'in', 0.1)]" />
                        <filter name="color_priority_need_move_4" string="Black" icon="terp-personal" domain="[('color_priority_need_move', '=', 4)]" />
                        <filter name="color_priority_need_move_3" string="Red" icon="terp-personal" domain="[('color_priority_need_move', '=', 3)]" />
                        <filter name="color_priority_need_move_2" string="Orange" icon="terp-personal" domain="[('color_priority_need_move', '=', 2)]" />
                        <filter name="color_priority_need_move_1" string="Green" icon="terp-personal" domain="[('color_priority_need_move', '=', 1)]" />
                        <filter name="not_cancelled" string="Not cancelled or done" domain="[('state', 'not in', ('done','cancel'))]" />
                        <filter name="is_subc_no_regul" string="Subc. regul is not ok" domain="[('is_subc_no_regul', '=', True)]" />
                        <separator orientation="vertical" />
                        <filter string="Week" domain="[('is_week', '=', True)]" />
                        <filter string="Following week" domain="[('is_next_week', '=', True)]" />
                        <filter string="Current month" domain="[('is_month', '=', True)]" />
                    </group>
                    <newline />
                    <group expand="0" string="Group By...">
                        <filter string="Year" icon="terp-partner" context="{'group_by' : 'year'}" />
                        <filter string="Month" icon="terp-partner" context="{'group_by' : 'month'}" />
                        <filter string="Week" icon="terp-partner" context="{'group_by' : 'week_number'}" />
                        <separator orientation="vertical" />
                        <filter string="Customer" icon="terp-partner" context="{'group_by' : 'customer_id'}" />
                        <separator orientation="vertical" />
                        <filter string="Product" icon="terp-partner" context="{'group_by' : 'final_product_id'}" name="mrp_filter_product" />
                        <separator orientation="vertical" />
                        <filter string="MO" icon="terp-partner" context="{'group_by' : 'mo_id'}" name="mrp_filter_mo" />
                        <separator orientation="vertical" />
                        <filter string="First Resource" icon="terp-partner" context="{'group_by' : 'first_resource_id'}" />
                        <separator orientation="vertical" />
                        <filter string="Group" icon="terp-partner" context="{'group_by' : 'group_wo_id'}" />
                        <separator orientation="vertical" />
                        <filter string="State" icon="terp-partner" context="{'group_by' : 'state'}" />
                    </group>
                </search>
            </field>
        </record>

        <!-- ACTION Workorder -->
        <record id="act_mrp_workorder" model="ir.actions.act_window">
            <field name="name">Workorder</field>
            <field name="res_model">mrp.workorder</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{'search_default_not_cancelled': 1}</field>
            <field name="search_view_id" ref="view_search_mrp_workorder" />
        </record>

        <record id="act_mrp_workorder_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_workorder" />
            <field name="act_window_id" ref="act_mrp_workorder" />
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_workorder_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_workorder" />
            <field name="act_window_id" ref="act_mrp_workorder" />
        </record>

        <!-- ACTION Partner Workorder tree -->
        <record model="ir.actions.act_window" id="action_see_all_workorder">
            <field name="name">Workorder</field>
            <field name="res_model">mrp.workorder</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="view_tree_mrp_workorder" />
            <field name="view_mode">tree,form</field>
            <field name="target">current</field>
            <field name="domain">[('customer_id', '=', context.get('customer_id', False))]</field>
        </record>

        <menuitem name="Workorder" action="act_mrp_workorder" id="menu_mrp_workorder" parent="menu_production_manufacturing" groups="group_menu_manuf_user" />
        <menuitem name="RM" action="action_purchase_subcontracting_rm" id="menu_mrp_purchase_subcontracting_rm" parent="menu_production_subcontracting" groups="group_menu_manuf_subcontracting" />
        <menuitem name="FP" action="action_purchase_subcontracting_fp" id="menu_mrp_purchase_subcontracting_fp" parent="menu_production_subcontracting" groups="group_menu_manuf_subcontracting" />
        <menuitem name="Subcontracting inventory location" action="action_subcontracting_inventory_location" id="menu_mrp_subcontracting_inventory_location" parent="menu_production_subcontracting" groups="group_menu_manuf_subcontracting" />
        <menuitem name="Declaration" id="menu_mrp_declaration_main" parent="menu_production_main" sequence="25" />
        <menuitem name="Declaration" action="action_wo_declaration_main" id="menu_mrp_Declaration" parent="menu_mrp_declaration_main" groups="group_menu_manuf_user" />
        <menuitem id="label_consumption_menu_action" action="label_consumption_action" parent="menu_mrp_declaration_main" />
        <menuitem id="label_consumption_grouped_menu_action" action="label_consumption_grouped_action" parent="menu_mrp_declaration_main" />

        <!-- ======================== -->
        <!-- Workorder Resource -->
        <!-- ======================== -->

        <!-- FORM VIEW Workorder Resource -->
        <record id='view_form_mrp_wo_resource' model='ir.ui.view'>
            <field name="name">view_form_mrp_wo_resource</field>
            <field name="model">mrp.wo.resource</field>
            <field name="arch" type="xml">
                <form string="Workorder Resource" version="8.0">
                    <group colspan="4" col="6">
                        <group colspan="2" col="2">
                            <field name="sequence" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="nb_product_parallel" />
                        </group>
                        <group colspan="2" col="2">
                        </group>
                    </group>
                    <group colspan="4" col="6">
                        <group colspan="2" col="2">
                            <field name="resource_id" readonly="1" />
                            <field name="preparation_time" widget="float_time_seconds" />
                            <field name="production_time" widget="float_time_seconds" />
                            <field name="cleaning_time" widget="float_time_seconds" />
                            <field name="difference" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="resource_category_id" readonly="1" />
                            <field name="total_preparation_time" widget="float_time_seconds" />
                            <field name="total_production_time" widget="float_time_seconds" />
                            <field name="total_cleaning_time" widget="float_time_seconds" />
                            <field name="total_time_theo" widget="float_time_seconds" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="nb_resource" />
                            <field name="preparation_masked_time" />
                            <field name="production_masked_time" />
                            <field name="cleaning_masked_time" />
                            <field name="total_time_real" widget="float_time_seconds" />
                        </group>
                    </group>
                </form>
            </field>
        </record>

        <!-- TREE VIEW Workorder Resource -->
        <record id='view_tree_mrp_wo_resource' model='ir.ui.view'>
            <field name="name">view_tree_mrp_wo_resource</field>
            <field name="model">mrp.wo.resource</field>
            <field name="arch" type="xml">
                <tree string="Workorder Resource" version="8.0">
                    <field name="sequence" />
                    <field name="resource_id" />
                    <field name="preparation_time" widget="float_time_seconds" />
                    <field name="production_time" widget="float_time_seconds" />
                    <field name="cleaning_time" widget="float_time_seconds" />
                    <field name="total_time_theo" widget="float_time_seconds" />
                    <field name="total_time_real" widget="float_time_seconds" />
                    <field name="difference" />
                </tree>
            </field>
        </record>


        <!-- ====================== -->
        <!-- Workorder Produce -->
        <!-- ====================== -->

        <!-- FORM VIEW Workorder Produce -->
        <record id='view_form_mrp_wo_produce' model='ir.ui.view'>
            <field name="name">view_form_mrp_wo_produce</field>
            <field name="model">mrp.wo.produce</field>
            <field name="arch" type="xml">
                <form string="Workorder Produce" version="8.0">
                    <group colspan="4" col="6">
                        <field name="date" />
                        <field name="user_id" />
                        <field name="state" />
                        <field name="qty_ok" />
                        <field name="qty_hs" />
                        <field name="qty_quarantine" />
                        <field name="uom_id" />
                        <field name="date_cancel" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                        <field name="user_cancel_id" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                        <field name="move_ids" colspan="6" nolabel="1" />
                        <field name="note" nolabel="1" colspan="6" />
                        <field name="note" colspan="6" />
                    </group>
                </form>
            </field>
        </record>


        <!-- TREE VIEW Workorder Produce -->
        <record id='view_tree_mrp_wo_produce' model='ir.ui.view'>
            <field name="name">view_tree_mrp_wo_produce</field>
            <field name="model">mrp.wo.produce</field>
            <field name="priority" eval="100" />
            <field name="arch" type="xml">
                <tree string="Workorder Produce" version="8.0">
                    <field name="date" />
                    <field name="qty_ok" />
                    <field name="uom_id" />
                    <field name="qty_hs" />
                    <field name="qty_quarantine" />
                    <field name="user_id" />
                    <field name="state" />
                    <field name="move_ids" />
                    <field name="note" />
                    <field name="st_wo" invisible="1" />
                    <field name="date_cancel" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                    <field name="user_cancel_id" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                    <button name="wkf_cancel" string="Cancel" type="object" class="oe_highlight" attrs="{'invisible':['|', ('state', '=', 'cancel'), ('st_wo', '=', True)]}" />
                </tree>
            </field>
        </record>


        <!-- TREE VIEW Workorder Produce -->
        <record id='view_tree_mrp_wo_produce_menu' model='ir.ui.view'>
            <field name="name">view_tree_mrp_wo_produce_menu</field>
            <field name="model">mrp.wo.produce</field>
            <field name="priority" eval="1000" />
            <field name="arch" type="xml">
                <tree string="Workorder Produce" version="8.0">
                    <field name="wo_id" />
                    <field name="product_id" />
                    <field name="qty_ok" />
                    <field name="uom_id" />
                    <field name="date" />
                    <field name="user_id" />
                    <field name="state" invisible="1" />
                    <field name="is_final" invisible="1" />
                    <field name="week_number" invisible="1" />
                    <field name="month" invisible="1" />
                    <field name="year" invisible="1" />
                    <field name="st_wo" invisible="1" />
                    <field name="date_cancel" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                    <field name="user_cancel_id" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                </tree>
            </field>
        </record>

        <record id="view_pivot_mrp_wo_produce_menu" model="ir.ui.view">
            <field name="name">view_pivot_mrp_wo_produce_menu</field>
            <field name="model">mrp.wo.produce</field>
            <field name="arch" type="xml">
                <pivot string="Workorder Produce">
                    <field name="product_id" type="row" />
                    <field name="year" type="col" />
                    <field name="month" type="col" />
                    <field name="week_number" type="col" />
                    <field name="qty_ok" type="measure" />
                </pivot>
            </field>
        </record>


        <!-- SEARCH VIEW Workorder Produce -->
        <record id='view_search_mrp_workorder_produce' model='ir.ui.view'>
            <field name="name">view_search_mrp_workorder_produce</field>
            <field name="model">mrp.wo.produce</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <field name="wo_id" />
                    <field name="product_id" />
                    <field name="user_id" />
                    <field name="week_number" />
                    <field name="month" />
                    <field name="year" />
                    <group string="Filters">
                        <filter name="current_month" string="Current month" icon="terp-personal" domain="[('is_month', '=', True)]" />
                        <filter name="current_week" string="Current week" icon="terp-personal" domain="[('is_week', '=', True)]" />
                        <filter name="yesterday" string="Yesterday" icon="terp-personal" domain="[('is_yesturday', '=', True)]" />
                        <filter name="today" string="Today" icon="terp-personal" domain="[('is_today', '=', True)]" />
                    </group>
                    <newline />
                    <group expand="0" string="Group By...">
                        <filter string="Year" icon="terp-partner" context="{'group_by' : 'year'}" />
                        <filter string="Month" icon="terp-partner" context="{'group_by' : 'month'}" />
                        <filter string="Week" icon="terp-partner" context="{'group_by' : 'week_number'}" />
                        <separator orientation="vertical" />
                        <filter string="Users" icon="terp-partner" context="{'group_by' : 'user_id'}" />
                        <separator orientation="vertical" />
                        <filter string="Product" icon="terp-partner" context="{'group_by' : 'product_id'}" />
                        <separator orientation="vertical" />
                        <filter string="WO" icon="terp-partner" context="{'group_by' : 'wo_id'}" />
                    </group>
                </search>
            </field>
        </record>


        <!-- ACTION Workorder -->
        <record id="act_view_tree_mrp_wo_produce_menu" model="ir.actions.act_window">
            <field name="name">Workorder Produce</field>
            <field name="res_model">mrp.wo.produce</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,pivot</field>
            <field name="domain">[('state', '=', 'done'), ('is_final', '=', True)]</field>
            <field name="search_view_id" ref="view_search_mrp_workorder_produce" />
        </record>


        <record id="act_view_tree_mrp_wo_produce_menu_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_wo_produce_menu" />
            <field name="act_window_id" ref="act_view_tree_mrp_wo_produce_menu" />
        </record>


        <menuitem name="Workorder Produce" action="act_view_tree_mrp_wo_produce_menu" sequence="30" id="menu_view_tree_mrp_wo_produce_menu" parent="menu_production_analysis" groups="group_menu_manuf_analyse" />



        <!-- ========================== -->
        <!-- Workorder Consumption -->
        <!-- ========================== -->

        <!-- FORM VIEW Workorder Consumption -->
        <record id='view_form_mrp_wo_consumption' model='ir.ui.view'>
            <field name="name">view_form_mrp_wo_consumption</field>
            <field name="model">mrp.wo.consumption</field>
            <field name="arch" type="xml">
                <form string="Workorder Consumption" version="8.0">
                    <group colspan="4" col="6">
                        <field name="date" />
                        <field name="quantity" />
                        <field name="uom_id" />
                        <field name="user_id" />
                        <field name="state" />
                        <field name="date_cancel" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                        <field name="user_cancel_id" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                        <field name="move_ids" colspan="6" nolabel="1" />
                        <field name="note" nolabel="1" colspan="6" />
                        <field name="note" colspan="6" />
                    </group>
                </form>
            </field>
        </record>


        <!-- TREE VIEW Workorder Consumption -->
        <record id='view_tree_mrp_wo_consumption' model='ir.ui.view'>
            <field name="name">view_tree_mrp_wo_consumption</field>
            <field name="model">mrp.wo.consumption</field>
            <field name="arch" type="xml">
                <tree string="Workorder Consumption" version="8.0">
                    <field name="date" />
                    <field name="quantity" />
                    <field name="uom_id" />
                    <field name="user_id" />
                    <field name="state" />
                    <field name="move_ids" />
                    <field name="note" />
                    <field name="st_wo" invisible="1" />
                    <field name="date_cancel" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                    <field name="user_cancel_id" attrs="{'invisible':[('state', '!=', 'cancel')]}" />
                    <button name="wkf_cancel" string="Cancel" type="object" class="oe_highlight" attrs="{'invisible':['|', ('state', '=', 'cancel'), ('st_wo', '=', True)]}" />
                </tree>
            </field>
        </record>



        <!-- ========================== -->
        <!-- RESOURCE TIMETRACKING -->
        <!-- ========================== -->

        <!-- TREE VIEW Resource Timetracking -->
        <record id='mrp_view_tree_wo_resource_timetracking' model='ir.ui.view'>
            <field name="name">mrp_view_tree_wo_resource_timetracking</field>
            <field name="model">resource.timetracking</field>
            <field name="inherit_id" ref="base_openprod.view_tree_resource_timetracking" />
            <field name="priority" eval="1400" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='resource_id']" position="after">
                    <field name="wo_id" />
                    <field name="group_wo_id" />
                </xpath>
            </field>
        </record>


        <!-- FORM VIEW Resource Timetracking -->
        <record id='mrp_view_form_resource_timetracking' model='ir.ui.view'>
            <field name="name">view_form_resource_timetracking</field>
            <field name="model">resource.timetracking</field>
            <field name="inherit_id" ref="base_openprod.view_form_resource_timetracking" />
            <field name="priority" eval="1400" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='time_spent']" position="after">
                    <field name="wo_id" readonly="1" />
                    <field name="group_wo_id" readonly="1" />
                </xpath>
            </field>
        </record>


        <!-- SEARCH VIEW Resource Timetracking -->
        <record id='mrp_view_search_wo_resource_timetracking' model='ir.ui.view'>
            <field name="name">mrp_view_search_wo_resource_timetracking</field>
            <field name="model">resource.timetracking</field>
            <field name="inherit_id" ref="base_openprod.view_search_resource_timetracking" />
            <field name="priority" eval="1400" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='resource_id']" position="after">
                    <field name="wo_id" />
                    <field name="group_wo_id" />
                </xpath>
            </field>
        </record>

        <menuitem name="Times declaration" action="act_wizard_create_timetracking_mrp" id="menu_wo_declaration_timetracking" parent="menu_mrp_declaration_main" groups="group_menu_manuf_user" />


        <!-- Vue des ots pour les ST -->
        <!-- TREE VIEW Workorder -->
        <record id='view_tree_mrp_workorder_st_procurment' model='ir.ui.view'>
            <field name="name">view_tree_mrp_workorder_st_procurment</field>
            <field name="model">mrp.workorder</field>
            <field name="arch" type="xml">
                <tree string="Workorders" version="8.0" colors="gray:state=='cancel'; blue:state=='draft'; brown:state=='done';">
                    <field name="color_priority_need_move" colors="red:color_priority_need_move==3; orange:color_priority_need_move==2; green:color_priority_need_move==1; black:color_priority_need_move==4" string=" " invisible="0" />
                    <field name="first_resource_id" />
                    <field name="final_product_id" />
                    <field name="name" />
                    <field name="mo_id" />
                    <field name="quantity" />
                    <field name="uom_id" />
                    <field name="planned_start_date" />
                    <field name="is_purchase_already" />
                    <button name="%(action_purchase_subcontracting_fp)d" string="FP" type="action" context="{'default_wo_id':active_id}" icon="fa-check" attrs="{'invisible':['|', ('is_subcontracting', '!=', True),('state', 'in', ('draft', 'waiting', 'cancel', 'done'))]}" />
                    <field name="real_start_date" invisible="1" />
                    <field name="availability" widget="progressbar" invisible="1" />
                    <field name="total_time_theo" widget="float_time_seconds" sum="Theo Total Time Sum" invisible="1" />
                    <field name="state" invisible="1" />
                    <field name="advancement" invisible="1" />
                    <field name="is_subcontracting" invisible="1" />
                    <field name="sequence" invisible="1" />
                    <field name="month" invisible="1" />
                    <field name="week_number" invisible="1" />
                    <field name="is_week" invisible="1" />
                    <field name="is_next_week" invisible="1" />
                    <field name="is_month" invisible="1" />
                </tree>
            </field>
        </record>

        <!-- ACTION Workorder -->
        <record id="act_mrp_workorder_st_procurment" model="ir.actions.act_window">
            <field name="name">Workorder</field>
            <field name="res_model">mrp.workorder</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('color_priority_need_move', '=', 4), ('is_subcontracting', '=', True)]</field>
            <field name="context">{'search_default_not_cancelled': 1}</field>
            <field name="search_view_id" ref="view_search_mrp_workorder" />
        </record>

        <record id="act_mrp_workorder_tree_st_procurment" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_workorder_st_procurment" />
            <field name="act_window_id" ref="act_mrp_workorder_st_procurment" />
        </record>

        <record model="ir.actions.act_window.view" id="act_mrp_workorder_form_st_procurment">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_workorder" />
            <field name="act_window_id" ref="act_mrp_workorder_st_procurment" />
        </record>



        <!-- FORM VIEW Group WO -->
        <record id='view_form_mrp_group_wo_id' model='ir.ui.view'>
            <field name="name">view_form_mrp_group_wo_id</field>
            <field name="model">mrp.group.wo</field>
            <field name="priority" eval="1" />
            <field name="arch" type="xml">
                <form string="Group WO" version="8.0">
                    <group colspan="4" col="4">
                        <group colspan="2" col="2">
                            <field name="name" />
                            <field name="duration_theo" widget="float_time_seconds" />
                            <field name="resource_id" domain="[('category_resource_ids', '=', categ_resource_id)]" />
                            <field name="categ_resource_id" invsible="1" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="planned_start_date" />
                            <field name="duration" widget="float_time_seconds" />
                            <field name="planned_end_date" />
                        </group>
                        <field name="wo_ids" colspan="4" nolabel="1" />
                    </group>
                </form>
            </field>
        </record>


        <!-- TREE VIEW Group WO -->
        <record id='view_tree_mrp_group_wo_id' model='ir.ui.view'>
            <field name="name">view_tree_mrp_group_wo_id</field>
            <field name="model">mrp.group.wo</field>
            <field name="arch" type="xml">
                <tree string="Group WOs" version="8.0">
                    <field name="name" />
                    <field name="resource_id" />
                    <field name="planned_start_date" />
                    <field name="duration" />
                    <field name="planned_end_date" />
                </tree>
            </field>
        </record>


        <!-- SEARCH VIEW Group WO -->
        <record id='view_search_mrp_group_wo_id' model='ir.ui.view'>
            <field name="name">view_search_mrp_group_wo_id</field>
            <field name="model">mrp.group.wo</field>
            <field name="arch" type="xml">
                <search version="8.0">
                    <field name="name" />
                    <field name="resource_id" />
                    <group expand="0" string="Group By...">
                        <filter string="Categ resource" icon="terp-partner" context="{'group_by' : 'categ_resource_id'}" />
                        <filter string="Resource" icon="terp-partner" context="{'group_by' : 'resource_id'}" />
                    </group>
                </search>
            </field>
        </record>


        <!-- ACTION Group WO -->
        <record id="act_mrp_group_wo_id" model="ir.actions.act_window">
            <field name="name">Group WO</field>
            <field name="res_model">mrp.group.wo</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="view_search_mrp_group_wo_id" />
        </record>


        <record id="act_mrp_group_wo_id_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="10" />
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_tree_mrp_group_wo_id" />
            <field name="act_window_id" ref="act_mrp_group_wo_id" />
        </record>


        <record model="ir.actions.act_window.view" id="act_mrp_group_wo_id_form">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_group_wo_id" />
            <field name="act_window_id" ref="act_mrp_group_wo_id" />
        </record>


        <menuitem name="Group WO" action="act_mrp_group_wo_id" id="menu_mrp_group_wo_id" parent="menu_production_manufacturing" groups="group_menu_manuf_user" />


        <record id='view_form_mrp_group_wo_id_wizard' model='ir.ui.view'>
            <field name="name">view_form_mrp_group_wo_id_wizard</field>
            <field name="model">mrp.group.wo</field>
            <field name="priority" eval="1000" />
            <field name="arch" type="xml">
                <form string="Group WO" version="8.0">
                    <group colspan="4" col="4">
                        <group colspan="2" col="2">
                            <field name="name" />
                            <field name="duration_theo" widget="float_time_seconds" />
                            <field name="resource_id" domain="[('category_resource_ids', '=', categ_resource_id)]" />
                            <field name="categ_resource_id" invsible="1" />
                        </group>
                        <group colspan="2" col="2">
                            <field name="planned_start_date" />
                            <field name="duration" widget="float_time_seconds" />
                            <field name="planned_end_date" />
                        </group>
                        <field name="wo_ids" colspan="4" nolabel="1" />
                    </group>
                    <footer>
                        <button name="action_validation" string="OK" type="object" class="oe_highlight" />
                        or
                        <button string="Cancel" class="oe_link" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>


        <act_window name="Group WO" res_model="mrp.group.wo" src_model="mrp.workorder" view_mode="form" target="new" key2="client_action_multi" id="act_mrp_group_wo_id_wizard2" context="{'default_wo_ids': context['active_ids']}" />


        <record model="ir.actions.act_window.view" id="act_mrp_group_wo_id_form_wizard">
            <field name="sequence" eval="20" />
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_form_mrp_group_wo_id_wizard" />
            <field name="act_window_id" ref="act_mrp_group_wo_id_wizard2" />
        </record>

    </data>
</openerp>